import{r as g,b as Tt,a as Je}from"./react-vendor-CP2YnuCL.js";import{B as Ct,R as kt,a as Te,N as Pt}from"./router-BIsLND5u.js";import{L as Lt,a as Rt,_ as Mt,C as Ot,r as Ce,E as Dt,v as Ut,b as $t,i as qt,g as Bt,c as Ft,d as Vt,e as Kt,f as Gt,h as re,j as Ht,k as zt,s as he,T as L,l as V,m as Wt,n as ke,G as Xt,o as Jt,p as Yt,q as Qt,t as Zt,u as Y,w as Q,x as q,y as es,z as ts,A as Z,B as ss,D as Pe,F as as,H as rs}from"./firebase-NLDiu20G.js";import{m as d,M as is,L as ns,E as ye,a as ve,A as Ye,C as ee,S as os,z as A,K as Qe,b as xe,Z as K,c as Ze,d as ls,e as et,f as tt,T as G,g as st,P as cs,B as at,h as te,R as ds,i as je,V as rt,X as Le,j as us,k as ms,l as ps,n as hs,U as xs,o as gs,p as fs,G as bs,q as ys,r as vs,s as js,F as ws}from"./ui-CoeQhY6M.js";import{G as Ns}from"./ai-BR_vQUHy.js";import{R as Re,L as Es,C as Me,X as Oe,Y as De,T as Ue,a as $e,B as As,b as Ss}from"./charts-CGzOYZ6J.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function s(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(i){if(i.ep)return;i.ep=!0;const n=s(i);fetch(i.href,n)}})();var it={exports:{}},ie={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _s=g,Is=Symbol.for("react.element"),Ts=Symbol.for("react.fragment"),Cs=Object.prototype.hasOwnProperty,ks=_s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ps={key:!0,ref:!0,__self:!0,__source:!0};function nt(r,t,s){var a,i={},n=null,o=null;s!==void 0&&(n=""+s),t.key!==void 0&&(n=""+t.key),t.ref!==void 0&&(o=t.ref);for(a in t)Cs.call(t,a)&&!Ps.hasOwnProperty(a)&&(i[a]=t[a]);if(r&&r.defaultProps)for(a in t=r.defaultProps,t)i[a]===void 0&&(i[a]=t[a]);return{$$typeof:Is,type:r,key:n,ref:o,props:i,_owner:ks.current}}ie.Fragment=Ts;ie.jsx=nt;ie.jsxs=nt;it.exports=ie;var e=it.exports,ge={},qe=Tt;ge.createRoot=qe.createRoot,ge.hydrateRoot=qe.hydrateRoot;const Be="@firebase/performance",fe="0.6.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ot=fe,Ls="FB-PERF-TRACE-START",Rs="FB-PERF-TRACE-STOP",be="FB-PERF-TRACE-MEASURE",lt="_wt_",ct="_fp",dt="_fcp",ut="_fid",mt="@firebase/performance/config",pt="@firebase/performance/configexpire",Ms="performance",ht="Performance";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Os={"trace started":"Trace {$traceName} was started before.","trace stopped":"Trace {$traceName} is not running.","nonpositive trace startTime":"Trace {$traceName} startTime should be positive.","nonpositive trace duration":"Trace {$traceName} duration should be positive.","no window":"Window is not available.","no app id":"App id is not available.","no project id":"Project id is not available.","no api key":"Api key is not available.","invalid cc log":"Attempted to queue invalid cc event","FB not default":"Performance can only start when Firebase app instance is the default one.","RC response not ok":"RC response is not ok","invalid attribute name":"Attribute name {$attributeName} is invalid.","invalid attribute value":"Attribute value {$attributeValue} is invalid.","invalid custom metric name":"Custom metric name {$customMetricName} is invalid","invalid String merger input":"Input for String merger is invalid, contact support team to resolve.","already initialized":"initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."},S=new Dt(Ms,ht,Os);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k=new Lt(ht);k.logLevel=Rt.INFO;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ce,xt;class E{constructor(t){if(this.window=t,!t)throw S.create("no window");this.performance=t.performance,this.PerformanceObserver=t.PerformanceObserver,this.windowLocation=t.location,this.navigator=t.navigator,this.document=t.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=t.localStorage),t.perfMetrics&&t.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=t.perfMetrics.onFirstInputDelay)}getUrl(){return this.windowLocation.href.split("?")[0]}mark(t){!this.performance||!this.performance.mark||this.performance.mark(t)}measure(t,s,a){!this.performance||!this.performance.measure||this.performance.measure(t,s,a)}getEntriesByType(t){return!this.performance||!this.performance.getEntriesByType?[]:this.performance.getEntriesByType(t)}getEntriesByName(t){return!this.performance||!this.performance.getEntriesByName?[]:this.performance.getEntriesByName(t)}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return!fetch||!Promise||!$t()?(k.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1):qt()?!0:(k.info("IndexedDB is not supported by current browser"),!1)}setupObserver(t,s){if(!this.PerformanceObserver)return;new this.PerformanceObserver(i=>{for(const n of i.getEntries())s(n)}).observe({entryTypes:[t]})}static getInstance(){return ce===void 0&&(ce=new E(xt)),ce}}function Ds(r){xt=r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gt;function Us(r){const t=r.getId();return t.then(s=>{gt=s}),t}function we(){return gt}function $s(r){const t=r.getToken();return t.then(s=>{}),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fe(r,t){const s=r.length-t.length;if(s<0||s>1)throw S.create("invalid String merger input");const a=[];for(let i=0;i<r.length;i++)a.push(r.charAt(i)),t.length>i&&a.push(t.charAt(i));return a.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let de;class T{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=Fe("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=Fe("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return de===void 0&&(de=new T),de}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var B;(function(r){r[r.UNKNOWN=0]="UNKNOWN",r[r.VISIBLE=1]="VISIBLE",r[r.HIDDEN=2]="HIDDEN"})(B||(B={}));const qs=["firebase_","google_","ga_"],Bs=new RegExp("^[a-zA-Z]\\w*$"),Fs=40,Vs=100;function Ks(){const r=E.getInstance().navigator;return r?.serviceWorker?r.serviceWorker.controller?2:3:1}function ft(){switch(E.getInstance().document.visibilityState){case"visible":return B.VISIBLE;case"hidden":return B.HIDDEN;default:return B.UNKNOWN}}function Gs(){const t=E.getInstance().navigator.connection;switch(t&&t.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}function Hs(r){return r.length===0||r.length>Fs?!1:!qs.some(s=>r.startsWith(s))&&!!r.match(Bs)}function zs(r){return r.length!==0&&r.length<=Vs}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bt(r){var t;const s=(t=r.options)===null||t===void 0?void 0:t.appId;if(!s)throw S.create("no app id");return s}function Ws(r){var t;const s=(t=r.options)===null||t===void 0?void 0:t.projectId;if(!s)throw S.create("no project id");return s}function Xs(r){var t;const s=(t=r.options)===null||t===void 0?void 0:t.apiKey;if(!s)throw S.create("no api key");return s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Js="0.0.1",C={loggingEnabled:!0},Ys="FIREBASE_INSTALLATIONS_AUTH";function Qs(r,t){const s=Zs();return s?(Ve(s),Promise.resolve()):sa(r,t).then(Ve).then(a=>ea(a),()=>{})}function Zs(){const r=E.getInstance().localStorage;if(!r)return;const t=r.getItem(pt);if(!t||!aa(t))return;const s=r.getItem(mt);if(s)try{return JSON.parse(s)}catch{return}}function ea(r){const t=E.getInstance().localStorage;!r||!t||(t.setItem(mt,JSON.stringify(r)),t.setItem(pt,String(Date.now()+T.getInstance().configTimeToLive*60*60*1e3)))}const ta="Could not fetch config, will use default configs";function sa(r,t){return $s(r.installations).then(s=>{const a=Ws(r.app),i=Xs(r.app),n=`https://firebaseremoteconfig.googleapis.com/v1/projects/${a}/namespaces/fireperf:fetch?key=${i}`,o=new Request(n,{method:"POST",headers:{Authorization:`${Ys} ${s}`},body:JSON.stringify({app_instance_id:t,app_instance_id_token:s,app_id:bt(r.app),app_version:ot,sdk_version:Js})});return fetch(o).then(c=>{if(c.ok)return c.json();throw S.create("RC response not ok")})}).catch(()=>{k.info(ta)})}function Ve(r){if(!r)return r;const t=T.getInstance(),s=r.entries||{};return s.fpr_enabled!==void 0?t.loggingEnabled=String(s.fpr_enabled)==="true":t.loggingEnabled=C.loggingEnabled,s.fpr_log_source?t.logSource=Number(s.fpr_log_source):C.logSource&&(t.logSource=C.logSource),s.fpr_log_endpoint_url?t.logEndPointUrl=s.fpr_log_endpoint_url:C.logEndPointUrl&&(t.logEndPointUrl=C.logEndPointUrl),s.fpr_log_transport_key?t.transportKey=s.fpr_log_transport_key:C.transportKey&&(t.transportKey=C.transportKey),s.fpr_vc_network_request_sampling_rate!==void 0?t.networkRequestsSamplingRate=Number(s.fpr_vc_network_request_sampling_rate):C.networkRequestsSamplingRate!==void 0&&(t.networkRequestsSamplingRate=C.networkRequestsSamplingRate),s.fpr_vc_trace_sampling_rate!==void 0?t.tracesSamplingRate=Number(s.fpr_vc_trace_sampling_rate):C.tracesSamplingRate!==void 0&&(t.tracesSamplingRate=C.tracesSamplingRate),t.logTraceAfterSampling=Ke(t.tracesSamplingRate),t.logNetworkAfterSampling=Ke(t.networkRequestsSamplingRate),r}function aa(r){return Number(r)>Date.now()}function Ke(r){return Math.random()<=r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ne=1,ue;function yt(r){return Ne=2,ue=ue||ia(r),ue}function ra(){return Ne===3}function ia(r){return na().then(()=>Us(r.installations)).then(t=>Qs(r,t)).then(()=>Ge(),()=>Ge())}function na(){const r=E.getInstance().document;return new Promise(t=>{if(r&&r.readyState!=="complete"){const s=()=>{r.readyState==="complete"&&(r.removeEventListener("readystatechange",s),t())};r.addEventListener("readystatechange",s)}else t()})}function Ge(){Ne=3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ee=10*1e3,oa=5.5*1e3,vt=3,la=1e3;let se=vt,R=[],He=!1;function ca(){He||(ne(oa),He=!0)}function ne(r){setTimeout(()=>{if(se!==0){if(!R.length)return ne(Ee);da()}},r)}function da(){const r=R.splice(0,la),t=r.map(a=>({source_extension_json_proto3:a.message,event_time_ms:String(a.eventTime)})),s={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:T.getInstance().logSource,log_event:t};ua(s,r).catch(()=>{R=[...r,...R],se--,k.info(`Tries left: ${se}.`),ne(Ee)})}function ua(r,t){return ma(r).then(s=>(s.ok||k.info("Call to Firebase backend failed."),s.json())).then(s=>{const a=Number(s.nextRequestWaitMillis);let i=Ee;isNaN(a)||(i=Math.max(a,i));const n=s.logResponseDetails;Array.isArray(n)&&n.length>0&&n[0].responseAction==="RETRY_REQUEST_LATER"&&(R=[...t,...R],k.info("Retry transport request later.")),se=vt,ne(i)})}function ma(r){const t=T.getInstance().getFlTransportFullUrl();return fetch(t,{method:"POST",body:JSON.stringify(r)})}function pa(r){if(!r.eventTime||!r.message)throw S.create("invalid cc log");R=[...R,r]}function ha(r){return(...t)=>{const s=r(...t);pa({message:s,eventTime:Date.now()})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let me;function jt(r,t){me||(me=ha(ga)),me(r,t)}function W(r){const t=T.getInstance();!t.instrumentationEnabled&&r.isAuto||!t.dataCollectionEnabled&&!r.isAuto||E.getInstance().requiredApisAvailable()&&(r.isAuto&&ft()!==B.VISIBLE||(ra()?pe(r):yt(r.performanceController).then(()=>pe(r),()=>pe(r))))}function pe(r){if(!we())return;const t=T.getInstance();!t.loggingEnabled||!t.logTraceAfterSampling||setTimeout(()=>jt(r,1),0)}function xa(r){const t=T.getInstance();if(!t.instrumentationEnabled)return;const s=r.url,a=t.logEndPointUrl.split("?")[0],i=t.flTransportEndpointUrl.split("?")[0];s===a||s===i||!t.loggingEnabled||!t.logNetworkAfterSampling||setTimeout(()=>jt(r,0),0)}function ga(r,t){return t===0?fa(r):ba(r)}function fa(r){const t={url:r.url,http_method:r.httpMethod||0,http_response_code:200,response_payload_bytes:r.responsePayloadBytes,client_start_time_us:r.startTimeUs,time_to_response_initiated_us:r.timeToResponseInitiatedUs,time_to_response_completed_us:r.timeToResponseCompletedUs},s={application_info:wt(r.performanceController.app),network_request_metric:t};return JSON.stringify(s)}function ba(r){const t={name:r.name,is_auto:r.isAuto,client_start_time_us:r.startTimeUs,duration_us:r.durationUs};Object.keys(r.counters).length!==0&&(t.counters=r.counters);const s=r.getAttributes();Object.keys(s).length!==0&&(t.custom_attributes=s);const a={application_info:wt(r.performanceController.app),trace_metric:t};return JSON.stringify(a)}function wt(r){return{google_app_id:bt(r),app_instance_id:we(),web_app_info:{sdk_version:ot,page_url:E.getInstance().getUrl(),service_worker_status:Ks(),visibility_state:ft(),effective_connection_type:Gs()},application_process_state:0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ya=100,va="_",ja=[ct,dt,ut];function wa(r,t){return r.length===0||r.length>ya?!1:t&&t.startsWith(lt)&&ja.indexOf(r)>-1||!r.startsWith(va)}function Na(r){const t=Math.floor(r);return t<r&&k.info(`Metric value should be an Integer, setting the value as : ${t}.`),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D{constructor(t,s,a=!1,i){this.performanceController=t,this.name=s,this.isAuto=a,this.state=1,this.customAttributes={},this.counters={},this.api=E.getInstance(),this.randomId=Math.floor(Math.random()*1e6),this.isAuto||(this.traceStartMark=`${Ls}-${this.randomId}-${this.name}`,this.traceStopMark=`${Rs}-${this.randomId}-${this.name}`,this.traceMeasure=i||`${be}-${this.randomId}-${this.name}`,i&&this.calculateTraceMetrics())}start(){if(this.state!==1)throw S.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(this.state!==2)throw S.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),W(this)}record(t,s,a){if(t<=0)throw S.create("nonpositive trace startTime",{traceName:this.name});if(s<=0)throw S.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(s*1e3),this.startTimeUs=Math.floor(t*1e3),a&&a.attributes&&(this.customAttributes=Object.assign({},a.attributes)),a&&a.metrics)for(const i of Object.keys(a.metrics))isNaN(Number(a.metrics[i]))||(this.counters[i]=Math.floor(Number(a.metrics[i])));W(this)}incrementMetric(t,s=1){this.counters[t]===void 0?this.putMetric(t,s):this.putMetric(t,this.counters[t]+s)}putMetric(t,s){if(wa(t,this.name))this.counters[t]=Na(s??0);else throw S.create("invalid custom metric name",{customMetricName:t})}getMetric(t){return this.counters[t]||0}putAttribute(t,s){const a=Hs(t),i=zs(s);if(a&&i){this.customAttributes[t]=s;return}if(!a)throw S.create("invalid attribute name",{attributeName:t});if(!i)throw S.create("invalid attribute value",{attributeValue:s})}getAttribute(t){return this.customAttributes[t]}removeAttribute(t){this.customAttributes[t]!==void 0&&delete this.customAttributes[t]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(t){this.startTimeUs=t}setDuration(t){this.durationUs=t}calculateTraceMetrics(){const t=this.api.getEntriesByName(this.traceMeasure),s=t&&t[0];s&&(this.durationUs=Math.floor(s.duration*1e3),this.startTimeUs=Math.floor((s.startTime+this.api.getTimeOrigin())*1e3))}static createOobTrace(t,s,a,i){const n=E.getInstance().getUrl();if(!n)return;const o=new D(t,lt+n,!0),c=Math.floor(E.getInstance().getTimeOrigin()*1e3);o.setStartTime(c),s&&s[0]&&(o.setDuration(Math.floor(s[0].duration*1e3)),o.putMetric("domInteractive",Math.floor(s[0].domInteractive*1e3)),o.putMetric("domContentLoadedEventEnd",Math.floor(s[0].domContentLoadedEventEnd*1e3)),o.putMetric("loadEventEnd",Math.floor(s[0].loadEventEnd*1e3)));const u="first-paint",p="first-contentful-paint";if(a){const m=a.find(h=>h.name===u);m&&m.startTime&&o.putMetric(ct,Math.floor(m.startTime*1e3));const l=a.find(h=>h.name===p);l&&l.startTime&&o.putMetric(dt,Math.floor(l.startTime*1e3)),i&&o.putMetric(ut,Math.floor(i*1e3))}W(o)}static createUserTimingTrace(t,s){const a=new D(t,s,!1,s);W(a)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ze(r,t){const s=t;if(!s||s.responseStart===void 0)return;const a=E.getInstance().getTimeOrigin(),i=Math.floor((s.startTime+a)*1e3),n=s.responseStart?Math.floor((s.responseStart-s.startTime)*1e3):void 0,o=Math.floor((s.responseEnd-s.startTime)*1e3),c=s.name&&s.name.split("?")[0],u={performanceController:r,url:c,responsePayloadBytes:s.transferSize,startTimeUs:i,timeToResponseInitiatedUs:n,timeToResponseCompletedUs:o};xa(u)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ea=5e3;function We(r){we()&&(setTimeout(()=>Sa(r),0),setTimeout(()=>Aa(r),0),setTimeout(()=>_a(r),0))}function Aa(r){const t=E.getInstance(),s=t.getEntriesByType("resource");for(const a of s)ze(r,a);t.setupObserver("resource",a=>ze(r,a))}function Sa(r){const t=E.getInstance(),s=t.getEntriesByType("navigation"),a=t.getEntriesByType("paint");if(t.onFirstInputDelay){let i=setTimeout(()=>{D.createOobTrace(r,s,a),i=void 0},Ea);t.onFirstInputDelay(n=>{i&&(clearTimeout(i),D.createOobTrace(r,s,a,n))})}else D.createOobTrace(r,s,a)}function _a(r){const t=E.getInstance(),s=t.getEntriesByType("measure");for(const a of s)Xe(r,a);t.setupObserver("measure",a=>Xe(r,a))}function Xe(r,t){const s=t.name;s.substring(0,be.length)!==be&&D.createUserTimingTrace(r,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ia{constructor(t,s){this.app=t,this.installations=s,this.initialized=!1}_init(t){this.initialized||(t?.dataCollectionEnabled!==void 0&&(this.dataCollectionEnabled=t.dataCollectionEnabled),t?.instrumentationEnabled!==void 0&&(this.instrumentationEnabled=t.instrumentationEnabled),E.getInstance().requiredApisAvailable()?Ut().then(s=>{s&&(ca(),yt(this).then(()=>We(this),()=>We(this)),this.initialized=!0)}).catch(s=>{k.info(`Environment doesn't support IndexedDB: ${s}`)}):k.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(t){T.getInstance().instrumentationEnabled=t}get instrumentationEnabled(){return T.getInstance().instrumentationEnabled}set dataCollectionEnabled(t){T.getInstance().dataCollectionEnabled=t}get dataCollectionEnabled(){return T.getInstance().dataCollectionEnabled}}const Ta="[DEFAULT]";function Ca(r=Bt()){return r=Ft(r),Vt(r,"performance").getImmediate()}const ka=(r,{options:t})=>{const s=r.getProvider("app").getImmediate(),a=r.getProvider("installations-internal").getImmediate();if(s.name!==Ta)throw S.create("FB not default");if(typeof window>"u")throw S.create("no window");Ds(window);const i=new Ia(s,a);return i._init(t),i};function Pa(){Mt(new Ot("performance",ka,"PUBLIC")),Ce(Be,fe),Ce(Be,fe,"esm2017")}Pa();const Nt={apiKey:"tu-api-key-aqui",authDomain:"english-master-app.firebaseapp.com",projectId:"english-master-app",storageBucket:"english-master-app.appspot.com",messagingSenderId:"123456789012",appId:"1:123456789012:web:abcdef123456",measurementId:"G-XXXXXXXXXX"},ae=Kt(Nt),O=Gt(ae);re(ae);typeof window<"u"&&(Ht().then(r=>{r&&(zt(ae),console.log("📊 Firebase Analytics initialized"))}),Ca(ae),console.log("⚡ Firebase Performance initialized"));O.useDeviceLanguage();console.log("🔥 Firebase initialized successfully");console.log("🏗️ Environment:","production");console.log("📱 Project ID:",Nt.projectId);class oe{db=re();static LEVEL_REQUIREMENTS={A1:{minExercises:40,minAccuracy:.7,minSessions:5,minTimeSpent:60,skillsRequired:["social_greetings","basic_needs","courtesy","personal_info"],description:"Supervivencia básica en inglés"},A2:{minExercises:80,minAccuracy:.75,minSessions:10,minTimeSpent:120,skillsRequired:["daily_routines","past_experiences","future_plans","preferences"],description:"Comunicación cotidiana"},B1:{minExercises:120,minAccuracy:.8,minSessions:15,minTimeSpent:180,skillsRequired:["work_situations","problem_solving","opinions","hypotheticals"],description:"Independencia comunicativa"},B2:{minExercises:160,minAccuracy:.85,minSessions:20,minTimeSpent:240,skillsRequired:["professional_communication","analysis","complex_grammar","nuanced_vocabulary"],description:"Fluidez profesional"}};async initializeUserProgress(t,s,a){const i={userId:t,email:s,currentLevel:"A1",totalExercises:0,totalCorrectAnswers:0,overallAccuracy:0,totalXP:0,totalTimeSpent:0,currentStreak:0,longestStreak:0,levelProgress:{A1:this.createInitialLevelStats(!0),A2:this.createInitialLevelStats(!1),B1:this.createInitialLevelStats(!1),B2:this.createInitialLevelStats(!1)},apiKey:this.encryptAPIKey(a),preferences:{dailyGoal:20,soundEnabled:!0,animationsEnabled:!0,explanationLanguage:"es",difficultyPreference:"adaptive"},unlockedAchievements:[],createdAt:new Date,lastActive:new Date};return await he(V(this.db,"userProgress",t),{...i,createdAt:L.fromDate(i.createdAt),lastActive:L.fromDate(i.lastActive)}),i}async updateProgress(t,s){return await Wt(this.db,async a=>{const i=V(this.db,"userProgress",t),n=await a.get(i);if(!n.exists())throw new Error("User progress not found");const o=this.convertFirestoreToProgress(n.data()),c=o.totalExercises+s.totalAnswers,u=o.totalCorrectAnswers+s.correctAnswers,p=u/c,m=o.currentLevel,l=o.levelProgress[m],h=l.exercisesCompleted+s.totalAnswers,f=l.correctAnswers+s.correctAnswers,x=f/h,j=Math.max(l.accuracy,x),y={...l,exercisesCompleted:h,correctAnswers:f,accuracy:j,xpEarned:l.xpEarned+s.xpEarned,timeSpent:l.timeSpent+s.timeSpent,sessionsCompleted:l.sessionsCompleted+1,lastSession:new Date,averageTime:Math.min(l.averageTime||60,(l.averageTime*l.exercisesCompleted+s.timeSpent*60/s.totalAnswers)/h),weakAreas:this.updateWeakAreas(l.weakAreas,s.weakAreasIdentified),strongAreas:this.updateStrongAreas(l.strongAreas,s.skillsFocused,s.accuracy)};console.log("📊 PROGRESO ACTUALIZADO:",{level:m,oldAccuracy:l.accuracy,newAccuracy:x,finalAccuracy:j,exercisesCompleted:y.exercisesCompleted,onlyPositiveProgress:j>=l.accuracy});const w=this.calculateProgress(m,y);let _=m,b={...o.levelProgress};w.canLevelUp&&m!=="B2"&&(_=this.getNextLevel(m),y.isCompleted=!0,y.completedAt=new Date,b[_].isUnlocked=!0,console.log(`🎉 LEVEL UP: ${m} → ${_}`)),b[m]=y;const M=new Date().toISOString().split("T")[0],le=new Date(Date.now()-864e5).toISOString().split("T")[0],H=o.lastActive.toISOString().split("T")[0];let U=o.currentStreak;H===le?U+=1:H!==M&&(U=1);const v={...o,currentLevel:_,totalExercises:c,totalCorrectAnswers:u,overallAccuracy:p,totalXP:o.totalXP+s.xpEarned,totalTimeSpent:o.totalTimeSpent+s.timeSpent,currentStreak:U,longestStreak:Math.max(o.longestStreak,U),levelProgress:b,lastActive:new Date,...w.canLevelUp&&{lastLevelUp:new Date}};return a.update(i,{...v,lastActive:L.fromDate(v.lastActive),...v.lastLevelUp&&{lastLevelUp:L.fromDate(v.lastLevelUp)},"levelProgress.A1.lastSession":v.levelProgress.A1.lastSession?L.fromDate(v.levelProgress.A1.lastSession):null,"levelProgress.A2.lastSession":v.levelProgress.A2.lastSession?L.fromDate(v.levelProgress.A2.lastSession):null,"levelProgress.B1.lastSession":v.levelProgress.B1.lastSession?L.fromDate(v.levelProgress.B1.lastSession):null,"levelProgress.B2.lastSession":v.levelProgress.B2.lastSession?L.fromDate(v.levelProgress.B2.lastSession):null}),await this.saveDailyProgress(t,s,v),v})}async getUserProgress(t){const s=await ke(V(this.db,"userProgress",t));return s.exists()?this.convertFirestoreToProgress(s.data()):null}calculateProgress(t,s){const a=oe.LEVEL_REQUIREMENTS[t],i=Math.min(1,s.exercisesCompleted/a.minExercises),n=Math.min(1,s.accuracy/a.minAccuracy),o=Math.min(1,s.sessionsCompleted/a.minSessions),c=Math.min(1,s.timeSpent/a.minTimeSpent),u=Math.round((i*.4+n*.3+o*.2+c*.1)*100),p=s.exercisesCompleted>=a.minExercises&&s.accuracy>=a.minAccuracy&&s.sessionsCompleted>=a.minSessions&&s.timeSpent>=a.minTimeSpent,m=[];return s.exercisesCompleted<a.minExercises&&m.push(`Ejercicios: ${s.exercisesCompleted}/${a.minExercises}`),s.accuracy<a.minAccuracy&&m.push(`Precisión: ${Math.round(s.accuracy*100)}%/${Math.round(a.minAccuracy*100)}%`),s.sessionsCompleted<a.minSessions&&m.push(`Sesiones: ${s.sessionsCompleted}/${a.minSessions}`),s.timeSpent<a.minTimeSpent&&m.push(`Tiempo: ${s.timeSpent}/${a.minTimeSpent} min`),{canLevelUp:p,progressPercentage:u,nextLevel:this.getNextLevel(t),requirements:a,currentStats:s,blockedBy:m,estimatedTimeToLevelUp:this.calculateEstimatedTime(s,a)}}async saveDailyProgress(t,s,a){const i=new Date().toISOString().split("T")[0],n=V(this.db,"dailyProgress",`${t}_${i}`),o=await ke(n),c={userId:t,date:i,exercisesCompleted:(o.exists()?o.data().exercisesCompleted:0)+s.totalAnswers,correctAnswers:(o.exists()?o.data().correctAnswers:0)+s.correctAnswers,accuracy:0,xpEarned:(o.exists()?o.data().xpEarned:0)+s.xpEarned,timeSpent:(o.exists()?o.data().timeSpent:0)+s.timeSpent,sessionsCompleted:(o.exists()?o.data().sessionsCompleted:0)+1,goalMet:!1,streak:a.currentStreak,level:a.currentLevel};c.accuracy=c.correctAnswers/c.exercisesCompleted,c.goalMet=c.exercisesCompleted>=a.preferences.dailyGoal,await he(n,c,{merge:!0})}createInitialLevelStats(t){return{exercisesCompleted:0,correctAnswers:0,accuracy:0,xpEarned:0,timeSpent:0,sessionsCompleted:0,isUnlocked:t,isCompleted:!1,weakAreas:[],strongAreas:[],averageTime:0}}getNextLevel(t){const s=["A1","A2","B1","B2"],a=s.indexOf(t);return s[Math.min(a+1,s.length-1)]}updateWeakAreas(t,s){const i=[...t,...s].reduce((n,o)=>(n[o]=(n[o]||0)+1,n),{});return Object.entries(i).filter(([n,o])=>o>=2).map(([n,o])=>n).slice(0,5)}updateStrongAreas(t,s,a){if(a>=.85){const i=[...t,...s];return Array.from(new Set(i)).slice(0,5)}return t}calculateEstimatedTime(t,s){const a=Math.max(0,s.minExercises-t.exercisesCompleted),i=t.averageTime||60;return a*i/60}encryptAPIKey(t){return btoa(t)}decryptAPIKey(t){return atob(t)}convertFirestoreToProgress(t){return{...t,createdAt:t.createdAt.toDate(),lastActive:t.lastActive.toDate(),lastLevelUp:t.lastLevelUp?.toDate(),levelProgress:{A1:{...t.levelProgress.A1,completedAt:t.levelProgress.A1.completedAt?.toDate(),lastSession:t.levelProgress.A1.lastSession?.toDate()},A2:{...t.levelProgress.A2,completedAt:t.levelProgress.A2.completedAt?.toDate(),lastSession:t.levelProgress.A2.lastSession?.toDate()},B1:{...t.levelProgress.B1,completedAt:t.levelProgress.B1.completedAt?.toDate(),lastSession:t.levelProgress.B1.lastSession?.toDate()},B2:{...t.levelProgress.B2,completedAt:t.levelProgress.B2.completedAt?.toDate(),lastSession:t.levelProgress.B2.lastSession?.toDate()}}}}}const La=()=>{const[r,t]=g.useState(!0),[s,a]=g.useState(""),[i,n]=g.useState(""),[o,c]=g.useState(!1),[u,p]=g.useState(!1),[m,l]=g.useState(""),h=new Xt;h.addScope("email"),h.addScope("profile");const f=async()=>{try{p(!0),l("");const y=await Jt(O,h);console.log("✅ Google sign in successful:",y.user.email),A.success(`¡Bienvenido ${y.user.displayName||y.user.email}!`)}catch(y){console.error("❌ Google sign in error:",y),l("Error al iniciar sesión con Google"),A.error("Error al iniciar sesión con Google")}finally{p(!1)}},x=async y=>{if(y.preventDefault(),!s||!i){l("Por favor completa todos los campos");return}if(i.length<6){l("La contraseña debe tener al menos 6 caracteres");return}try{if(p(!0),l(""),r){const w=await Yt(O,s,i);console.log("✅ Email sign in successful:",w.user.email),A.success("¡Sesión iniciada correctamente!")}else{const w=await Qt(O,s,i);console.log("✅ Account created successfully:",w.user.email),A.success("¡Cuenta creada exitosamente!")}}catch(w){console.error("❌ Email auth error:",w);const _={"auth/user-not-found":"Usuario no encontrado","auth/wrong-password":"Contraseña incorrecta","auth/email-already-in-use":"Este email ya está registrado","auth/weak-password":"La contraseña es muy débil","auth/invalid-email":"Email inválido","auth/too-many-requests":"Demasiados intentos. Intenta más tarde"};l(_[w.code]||"Error de autenticación"),A.error(_[w.code]||"Error de autenticación")}finally{p(!1)}},j=async()=>{if(!s){l("Ingresa tu email para recuperar la contraseña");return}try{await Zt(O,s),A.success("Email de recuperación enviado")}catch{A.error("Error enviando email de recuperación")}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center p-4",children:e.jsx(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"max-w-md w-full",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 border border-gray-200/50",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx(d.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring"},className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-white font-bold text-xl",children:"EM"})}),e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-2",children:"English Master"}),e.jsx("p",{className:"text-gray-600",children:r?"Inicia sesión en tu cuenta":"Crea tu cuenta nueva"})]}),e.jsxs(d.button,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3},onClick:f,disabled:u,className:"w-full flex items-center justify-center space-x-3 p-4 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors disabled:opacity-50 mb-6",children:[e.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),e.jsx("span",{className:"font-medium text-gray-700",children:r?"Continuar con Google":"Registrarse con Google"})]}),e.jsxs("div",{className:"flex items-center my-6",children:[e.jsx("div",{className:"flex-1 border-t border-gray-300"}),e.jsx("span",{className:"px-4 text-sm text-gray-500",children:"o"}),e.jsx("div",{className:"flex-1 border-t border-gray-300"})]}),e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs(d.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.4},children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(is,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"email",value:s,onChange:y=>{a(y.target.value),l("")},className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"tu@email.com",disabled:u})]})]}),e.jsxs(d.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.5},children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contraseña"}),e.jsxs("div",{className:"relative",children:[e.jsx(ns,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:o?"text":"password",value:i,onChange:y=>{n(y.target.value),l("")},className:"w-full pl-10 pr-10 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"••••••••",disabled:u}),e.jsx("button",{type:"button",onClick:()=>c(!o),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:o?e.jsx(ye,{className:"w-5 h-5"}):e.jsx(ve,{className:"w-5 h-5"})})]})]}),m&&e.jsxs(d.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"p-3 bg-red-50 border border-red-200 rounded-xl flex items-start space-x-2",children:[e.jsx(Ye,{className:"w-5 h-5 text-red-500 mt-0.5"}),e.jsx("p",{className:"text-red-700 text-sm",children:m})]}),e.jsx(d.button,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},type:"submit",disabled:u,className:"w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white py-3 rounded-xl font-bold text-lg shadow-lg hover:shadow-xl transition-all duration-300 disabled:opacity-50",children:u?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(d.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full"}),e.jsx("span",{children:r?"Iniciando sesión...":"Creando cuenta..."})]}):e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[r?e.jsx(ee,{className:"w-5 h-5"}):e.jsx(os,{className:"w-5 h-5"}),e.jsx("span",{children:r?"Iniciar Sesión":"Crear Cuenta"})]})})]}),e.jsxs("div",{className:"mt-6 text-center space-y-3",children:[r&&e.jsx("button",{onClick:j,className:"text-sm text-blue-600 hover:text-blue-800 transition-colors",disabled:u,children:"¿Olvidaste tu contraseña?"}),e.jsxs("div",{className:"text-sm text-gray-600",children:[r?"¿No tienes cuenta?":"¿Ya tienes cuenta?"," ",e.jsx("button",{onClick:()=>{t(!r),l("")},className:"text-blue-600 hover:text-blue-800 font-medium transition-colors",disabled:u,children:r?"Crear cuenta":"Iniciar sesión"})]})]})]})})})};class Ae{db=re();static DIVERSITY_REQUIREMENTS={A1:{minVariationsPerSkill:5,maxRepeatFrequency:7,skillDistribution:{social_greetings:.25,basic_needs:.25,courtesy:.2,personal_info:.15,emergency_help:.15},difficultyProgression:!0},A2:{minVariationsPerSkill:8,maxRepeatFrequency:10,skillDistribution:{daily_routines:.3,past_experiences:.25,future_plans:.2,preferences:.15,basic_conversation:.1},difficultyProgression:!0},B1:{minVariationsPerSkill:10,maxRepeatFrequency:14,skillDistribution:{work_situations:.25,problem_solving:.25,opinions:.2,hypotheticals:.15,complex_grammar:.15},difficultyProgression:!0},B2:{minVariationsPerSkill:12,maxRepeatFrequency:21,skillDistribution:{professional_communication:.3,analysis:.25,nuanced_vocabulary:.2,advanced_grammar:.15,cultural_context:.1},difficultyProgression:!0}};async generateDiverseExercises(t,s,a=8){try{console.log(`🎯 Generando ${a} ejercicios diversos para ${s}`);const i=await this.getUserExerciseHistory(t,s),n=await this.createDiversityPlan(t,s,a,i),o=await this.generateWithConstraints(t,s,n),c=await this.validateDiversity(o,i);return await this.saveExercisesToHistory(t,s,c),console.log(`✅ ${c.length} ejercicios diversos generados`),c}catch(i){throw console.error("❌ Error generating diverse exercises:",i),i}}async getUserExerciseHistory(t,s){try{const a=Y(this.db,"exerciseHistory"),i=Q(a,q("userId","==",t),q("level","==",s),es("timestamp","desc"),ts(200));return(await Z(i)).docs.map(o=>({...o.data(),timestamp:o.data().timestamp.toDate()}))}catch(a){return console.warn("⚠️ Error loading history, using empty:",a),[]}}async createDiversityPlan(t,s,a,i){const n=Ae.DIVERSITY_REQUIREMENTS[s],o=i.reduce((h,f)=>(h[f.skillFocus]=(h[f.skillFocus]||0)+1,h),{}),c=Object.keys(n.skillDistribution).filter(h=>(o[h]||0)<n.minVariationsPerSkill).sort((h,f)=>(o[h]||0)-(o[f]||0)),u={},p=c.slice(0,Math.ceil(a*.6));p.forEach((h,f)=>{u[h]=Math.ceil(a/p.length)});const m=a-Object.values(u).reduce((h,f)=>h+f,0),l=Object.keys(n.skillDistribution).filter(h=>!p.includes(h));return l.forEach(h=>{u[h]=Math.floor(m/l.length)}),{targetDistribution:u,avoidQuestions:i.slice(0,50).map(h=>h.questionHash),difficultyRange:this.calculateDifficultyRange(s,i),situationVariety:this.getSituationVariety(s),grammarFocus:this.getGrammarFocus(s,i)}}async generateWithConstraints(t,s,a){const i=[];for(const[n,o]of Object.entries(a.targetDistribution))if(!(typeof o!="number"||o<=0))for(let c=0;c<o;c++){const u=this.buildConstrainedPrompt(s,n,a,i.length+1);try{const p=await this.generateSingleExercise(u,s,n);p&&this.validateExerciseUniqueness(p,i)&&i.push(p)}catch(p){console.warn(`⚠️ Error generating exercise for ${n}:`,p)}}return i}buildConstrainedPrompt(t,s,a,i){const n=a.situationVariety[s]||[],o=n[i%n.length];return`GENERA UN EJERCICIO ÚNICO Y ESPECÍFICO PARA NIVEL ${t}

🎯 SKILL OBLIGATORIO: ${s}
🎭 SITUACIÓN ESPECÍFICA: ${o}
🚫 EVITAR COMPLETAMENTE: ${a.avoidQuestions.join(", ")}

REGLAS ESTRICTAS DE DIVERSIDAD:
1. La situación debe ser EXACTAMENTE: ${o}
2. NUNCA usar estas frases prohibidas: ${this.getProhibitedPhrases(t)}
3. Dificultad: ${a.difficultyRange.min} - ${a.difficultyRange.max}
4. Gramática focus: ${a.grammarFocus}

FORMATO JSON REQUERIDO:
{
  "id": "${t}_${s}_unique_${Date.now()}_${i}",
  "type": "multiple_choice",
  "situation": "${o}",
  "question": "[PREGUNTA ÚNICA EN ESPAÑOL PARA A1]",
  "options": ["[opción 1]", "[opción 2]", "[opción 3]", "[opción 4]"],
  "correct_answer": 0,
  "explanation": "[Explicación pedagógica detallada]",
  "level": "${t}",
  "skill_focus": "${s}",
  "difficulty": ${a.difficultyRange.min+Math.random()*(a.difficultyRange.max-a.difficultyRange.min)},
  "uniqueness_hash": "${this.generateUniqueHash(o,s)}"
}

GENERA 1 EJERCICIO COMPLETAMENTE ÚNICO Y ÚTIL.`}getProhibitedPhrases(t){const s=["Good morning","Hello","Thank you","I'm hungry","What time is it","My name is","How are you","Nice to meet you","Goodbye","See you later"];return{A1:[...s],A2:[...s,"I went to","I like","I have"],B1:[...s,"I think","I believe","In my opinion"],B2:[...s,"However","Nevertheless","Furthermore"]}[t]||s}getSituationVariety(t){return{A1:{social_greetings:["Te encuentras con tu jefe en el ascensor por la mañana","Un cliente entra a la tienda donde trabajas","Te cruzas con tu vecino en el supermercado","Llegas tarde a una reunión y necesitas saludar","Un turista te pregunta algo en la calle"],basic_needs:["Estás en un restaurante y tienes mucha sed","Necesitas encontrar un baño urgentemente en un centro comercial","Tienes hambre en el trabajo y no hay comida","Hace frío y necesitas cerrar la ventana","Necesitas ayuda para cargar algo pesado"],courtesy:["Alguien te sostiene la puerta abierta","Un compañero te presta su bolígrafo","Te traen la comida que pediste","Alguien te felicita por tu trabajo","Un extraño te devuelve algo que se te cayó"]},A2:{daily_routines:["Describes tu rutina matutina a un compañero nuevo","Explicas qué haces los fines de semana","Hablas sobre tu horario de trabajo","Describes cómo llegas al trabajo cada día","Explicas tus hábitos de ejercicio"]}}[t]||{}}generateUniqueHash(t,s){const a=`${t}_${s}_${Date.now()}`;let i=0;for(let n=0;n<a.length;n++){const o=a.charCodeAt(n);i=(i<<5)-i+o,i=i&i}return Math.abs(i).toString(36)}async saveExercisesToHistory(t,s,a){try{const i=`session_${Date.now()}`;for(const n of a){const o={userId:t,level:s,questionHash:n.uniqueness_hash||n.id,questionText:n.question,skillFocus:n.skill_focus,difficulty:n.difficulty,timestamp:new Date,sessionId:i};await he(V(this.db,"exerciseHistory",`${t}_${n.id}`),{...o,timestamp:ss()})}console.log(`💾 ${a.length} ejercicios guardados en historial Firebase`)}catch(i){console.error("❌ Error saving to history:",i)}}calculateDifficultyRange(t,s){const a={A1:{min:.1,max:.3},A2:{min:.3,max:.5},B1:{min:.5,max:.7},B2:{min:.7,max:.9}};return a[t]||a.A1}getGrammarFocus(t,s){const a={A1:"present simple, verb to be, basic questions",A2:"past simple, present perfect, future with going to",B1:"conditionals, passive voice, modal verbs",B2:"advanced tenses, subjunctive, complex structures"};return a[t]||a.A1}async generateSingleExercise(t,s,a){return{id:`${s}_${a}_${Date.now()}`,type:"multiple_choice",situation:"Situación única generada",question:"Pregunta única generada",options:["Opción 1","Opción 2","Opción 3","Opción 4"],correct_answer:0,explanation:"Explicación única",level:s,skill_focus:a,difficulty:.5,uniqueness_hash:this.generateUniqueHash(`${s}_${a}`,Date.now().toString())}}validateExerciseUniqueness(t,s){return!s.some(a=>a.question===t.question||a.uniqueness_hash===t.uniqueness_hash)}async validateDiversity(t,s){return t.filter(a=>!s.some(i=>i.questionText===a.question))}}class Et{genAI;diversityEngine;constructor(t){this.genAI=new Ns(t),this.diversityEngine=new Ae}async generateExercises(t){try{console.log(`🎯 Generando ejercicios DIVERSOS ${t.level} para usuario ${t.userId}`);const s=await this.diversityEngine.generateDiverseExercises(t.userId,t.level,8);if(s.length>0){const a=await this.enhanceWithAI(s,t);if(a.length>=4)return console.log(`✅ ${a.length} ejercicios DIVERSOS generados exitosamente`),a}return console.warn("⚠️ Diversity engine falló, usando método alternativo"),await this.generateWithStrictConstraints(t)}catch(s){return console.error("❌ Error generando ejercicios diversos:",s),this.generateEmergencyExercisesUnique(t.level,t.userId)}}async enhanceWithAI(t,s){const a=[];for(const i of t)try{const n=`MEJORA ESTE EJERCICIO BASE MANTENIENDO SU UNIQUENESS:

EJERCICIO BASE:
${JSON.stringify(i,null,2)}

REGLAS ESTRICTAS:
1. MANTENER la situación exacta: "${i.situation}"
2. MANTENER el skill focus: "${i.skill_focus}"
3. MEJORAR la pregunta para ser más natural y pedagógica
4. GENERAR opciones completamente diferentes pero lógicas
5. NUNCA usar estas frases prohibidas: "Good morning", "Hello", "Thank you", "I'm hungry"

FORMATO JSON EXACTO:
{
  "id": "${i.id}",
  "type": "multiple_choice",
  "situation": "${i.situation}",
  "question": "[PREGUNTA MEJORADA EN ESPAÑOL]",
  "options": ["[opción única 1]", "[opción única 2]", "[opción única 3]", "[opción única 4]"],
  "correct_answer": 0,
  "explanation": "[Explicación pedagógica detallada]",
  "level": "${s.level}",
  "skill_focus": "${i.skill_focus}",
  "difficulty": ${i.difficulty}
}`,p=(await this.genAI.getGenerativeModel({model:"gemini-1.5-flash",generationConfig:{temperature:.9,topP:.9,topK:50,maxOutputTokens:1024}}).generateContent(n)).response.text().match(/\{[\s\S]*\}/);if(p){const m=JSON.parse(p[0]);if(this.validateUniqueness(m,a)){const l=this.shuffleOptions(m);a.push(l),console.log(`✅ Ejercicio mejorado: ${m.skill_focus}`)}}}catch(n){console.warn("⚠️ Error mejorando ejercicio:",n)}return a}async generateWithStrictConstraints(t){const s=`GENERA 8 EJERCICIOS COMPLETAMENTE ÚNICOS PARA NIVEL ${t.level}

🚨 CONSTRAINTS ESTRICTOS:
1. CADA EJERCICIO debe tener una situación COMPLETAMENTE DIFERENTE
2. NUNCA repetir estas frases: "Good morning", "Hello", "Thank you", "I'm hungry", "What time is it", "My name is"
3. Usar situaciones ESPECÍFICAS y REALISTAS
4. Variar entre diferentes skills: social_greetings, basic_needs, courtesy, personal_info, emergency_help

EJEMPLOS DE SITUACIONES ÚNICAS:
- "Estás en el dentista y necesitas explicar que te duele"
- "Un compañero de trabajo te invita a almorzar"
- "Necesitas pedir direcciones para llegar al aeropuerto"
- "Tu vecino te pregunta si puedes cuidar su gato"
- "Estás en una farmacia y necesitas medicina"

FORMATO JSON - 8 EJERCICIOS ÚNICOS:
{
  "exercises": [
    {
      "id": "unique_${Date.now()}_1",
      "situation": "[SITUACIÓN COMPLETAMENTE ÚNICA]",
      "question": "[PREGUNTA ÚNICA EN ESPAÑOL]",
      "options": ["[opción 1]", "[opción 2]", "[opción 3]", "[opción 4]"],
      "correct_answer": 0,
      "explanation": "[Explicación pedagógica]",
      "level": "${t.level}",
      "skill_focus": "[skill específico]"
    }
  ]
}`;try{const o=(await this.genAI.getGenerativeModel({model:"gemini-1.5-flash",generationConfig:{temperature:1,topP:.95,topK:60,maxOutputTokens:3e3}}).generateContent(s)).response.text().match(/\{[\s\S]*\}/);if(o)return JSON.parse(o[0]).exercises.map((u,p)=>this.shuffleOptions({...u,id:`unique_${t.userId}_${Date.now()}_${p}`,difficulty:this.calculateDifficulty(u,t.level)}))}catch(a){console.error("❌ Error con constraints estrictos:",a)}return this.generateEmergencyExercisesUnique(t.level,t.userId)}validateExercise(t,s){const a=[],i=[];let n=1;if((!t.question||typeof t.question!="string")&&a.push("Pregunta faltante o inválida"),(!t.options||!Array.isArray(t.options)||t.options.length!==4)&&a.push("Debe tener exactamente 4 opciones"),typeof t.correct_answer!="number"&&typeof t.correct_answer!="string"&&a.push("Respuesta correcta inválida"),(!t.explanation||typeof t.explanation!="string")&&a.push("Explicación faltante"),s==="A1"){const u=this.validateA1Exercise(t);a.push(...u.errors),i.push(...u.warnings),n*=u.score}else if(s==="A2"){const u=this.validateA2Exercise(t);a.push(...u.errors),i.push(...u.warnings),n*=u.score}const o=this.validateSocialLogic(t);o.isValid||(a.push(...o.errors),n*=.5);const c=this.validateOptionDiversity(t.options);return c.isValid||(i.push(...c.warnings),n*=.9),{isValid:a.length===0,errors:a,warnings:i,pedagogicalScore:n}}validateA1Exercise(t){const s=[],a=[];let i=1;return this.detectLanguage(t.question)!=="spanish"&&(s.push("A1: La pregunta debe estar en ESPAÑOL"),i*=.1),t.options.every(p=>this.detectLanguage(p)==="english")||(s.push("A1: Todas las opciones deben estar en INGLÉS"),i*=.3),this.isSurvivalSituation(t.situation||t.question)||(s.push("A1: Debe ser una situación de supervivencia básica"),i*=.5),this.hasAdvancedVocabulary(t.options.join(" "))&&(a.push("A1: Contiene vocabulario avanzado"),i*=.8),{errors:s,warnings:a,score:i}}validateA2Exercise(t){const s=[],a=[];let i=1;return this.detectLanguage(t.question)==="unknown"&&(a.push("A2: Idioma de pregunta no detectado claramente"),i*=.9),this.hasA2Grammar(t.question+" "+t.options.join(" "))||(a.push("A2: Debería incluir gramática de nivel A2"),i*=.8),{errors:s,warnings:a,score:i}}validateSocialLogic(t){const s=[],a=(t.situation||t.question).toLowerCase(),i=t.options[typeof t.correct_answer=="number"?t.correct_answer:t.options.indexOf(t.correct_answer)]?.toLowerCase()||"",n=[{condition:a.includes("dice hello")||a.includes("saluda"),expectedResponses:["hello","hi","good morning"],name:"Responder saludo"},{condition:a.includes("te da")||a.includes("gives you"),expectedResponses:["thank you","thanks","gracias"],name:"Agradecer cuando reciben algo"},{condition:a.includes("dice thank you")||a.includes("te agradece"),expectedResponses:["you're welcome","no problem","de nada"],name:"Responder a agradecimiento"}];for(const o of n)o.condition&&(o.expectedResponses.some(u=>i.includes(u.toLowerCase()))||s.push(`Lógica social incorrecta: ${o.name}`));return{isValid:s.length===0,errors:s}}detectLanguage(t){const s=["qué","cómo","dónde","cuándo","por","para","con","sin","te","le","se","es","está"],a=["what","how","where","when","the","and","you","are","is","can","do","have"],i=t.toLowerCase(),n=s.filter(c=>i.includes(c)).length,o=a.filter(c=>i.includes(c)).length;return n>o?"spanish":o>n?"english":"unknown"}isSurvivalSituation(t){const s=["saluda","hello","hola","dice","da","gives","comida","food","thank you","gracias","agradece","nombre","name","llamas","hambre","hungry","sed","thirsty","baño","bathroom","perdido","lost","ayuda","help","excuse me"],a=t.toLowerCase();return s.some(i=>a.includes(i))}hasAdvancedVocabulary(t){const s=["sophisticated","comprehensive","substantial","significant","consequently","nevertheless","furthermore","moreover","perspective","analyze","evaluate","implement"],a=t.toLowerCase();return s.some(i=>a.includes(i))}hasA2Grammar(t){const s=["went","did","was","were","going to","will","have been","has been","would like","prefer"],a=t.toLowerCase();return s.some(i=>a.includes(i))}validateOptionDiversity(t){const s=[],a=t.map(c=>c.length),i=a.reduce((c,u)=>c+u,0)/a.length;a.some(c=>Math.abs(c-i)>i*.5)||s.push("Opciones tienen longitud muy similar");const o=new Set;return t.forEach(c=>{c.toLowerCase().split(" ").forEach(u=>o.add(u))}),o.size<t.length*2&&s.push("Opciones semánticamente muy similares"),{isValid:s.length===0,warnings:s}}shuffleOptions(t){const s=t.options[t.correct_answer],a=[...t.options];for(let n=a.length-1;n>0;n--){const o=Math.floor(Math.random()*(n+1));[a[n],a[o]]=[a[o],a[n]]}const i=a.findIndex(n=>n===s);return{...t,options:a,correct_answer:i}}calculateDifficulty(t,s){let a=.5;a={A1:.2,A2:.4,B1:.6,B2:.8}[s];const n=t.question.length;return n>100&&(a+=.1),n>150&&(a+=.1),this.hasAdvancedVocabulary(t.options.join(" "))&&(a+=.2),Math.min(1,Math.max(0,a))}validateUniqueness(t,s){const a=t.question.toLowerCase().split(" ");for(const i of s){const n=i.question.toLowerCase().split(" ");if(a.filter(c=>n.includes(c)).length>a.length*.5)return console.warn(`❌ Ejercicio muy similar rechazado: ${t.question}`),!1}return!0}generateEmergencyExercisesUnique(t,s){const a=Date.now(),i={A1:[{id:`emergency_${s}_${a}_1`,situation:"Estás en el dentista y necesitas explicar que te duele una muela",question:"¿Cómo expresas que tienes dolor de muelas?",options:["My tooth hurts","I'm happy","I'm cold","I'm tired"],correct_answer:0,explanation:"Para expresar dolor usamos 'hurts'. 'My tooth hurts' = Me duele la muela.",skill_focus:"health_emergencies"},{id:`emergency_${s}_${a}_2`,situation:"Un compañero de trabajo te invita a almorzar",question:"¿Cómo aceptas la invitación educadamente?",options:["Yes, I'd like that","No, never","Maybe tomorrow","I don't know"],correct_answer:0,explanation:"'Yes, I'd like that' es una forma educada de aceptar una invitación.",skill_focus:"workplace_social"},{id:`emergency_${s}_${a}_3`,situation:"Necesitas pedir direcciones para llegar al aeropuerto",question:"¿Cómo pides direcciones al aeropuerto?",options:["How do I get to the airport?","Where is food?","What time is it?","I like planes"],correct_answer:0,explanation:"'How do I get to...' es la forma correcta de pedir direcciones.",skill_focus:"navigation"},{id:`emergency_${s}_${a}_4`,situation:"Tu vecino te pregunta si puedes cuidar su gato mientras viaja",question:"¿Cómo respondes que sí puedes ayudar?",options:["Sure, I can help","I hate cats","Maybe not","I don't understand"],correct_answer:0,explanation:"'Sure, I can help' es una respuesta positiva y útil para ofrecer ayuda.",skill_focus:"neighborly_help"},{id:`emergency_${s}_${a}_5`,situation:"Estás en una farmacia y necesitas medicina para el dolor de cabeza",question:"¿Cómo pides medicina para el dolor de cabeza?",options:["I need something for headache","I want candy","Where is water?","I'm very happy"],correct_answer:0,explanation:"'I need something for...' es la forma correcta de pedir medicina específica.",skill_focus:"pharmacy_needs"},{id:`emergency_${s}_${a}_6`,situation:"Llegas tarde al trabajo y necesitas disculparte con tu jefe",question:"¿Cómo te disculpas por llegar tarde?",options:["Sorry I'm late","Hello boss","Good morning","I'm here now"],correct_answer:0,explanation:"'Sorry I'm late' es la disculpa apropiada cuando llegas tarde.",skill_focus:"workplace_apology"},{id:`emergency_${s}_${a}_7`,situation:"Estás en un restaurante y la comida está fría",question:"¿Cómo reportas que la comida está fría?",options:["This food is cold","I'm very cold","The weather is cold","Cold is good"],correct_answer:0,explanation:"'This food is cold' identifica específicamente el problema con la comida.",skill_focus:"restaurant_complaints"},{id:`emergency_${s}_${a}_8`,situation:"Un turista te pregunta dónde está la estación de tren",question:"¿Cómo direccionas a alguien hacia la estación de tren?",options:["The train station is over there","I don't like trains","Trains are fast","What is a train?"],correct_answer:0,explanation:"Para dar direcciones usamos 'The [lugar] is over there' (está por allá).",skill_focus:"giving_directions"}],A2:[],B1:[],B2:[]};return(i[t]||i.A1).map(o=>this.shuffleOptions({...o,type:"multiple_choice",level:t,difficulty:.3}))}generateEmergencyExercises(t){const s={A1:[{id:"emergency_a1_001",type:"multiple_choice",situation:"Te encuentras con un compañero y te dice Hello",question:"¿Qué debes responder para ser educado?",options:["Hello","You're welcome","I'm sorry","Goodbye"],correct_answer:0,explanation:'Cuando alguien te saluda con "Hello", debes saludar de vuelta. Es cortesía básica.',level:"A1",skill_focus:"social_greetings",difficulty:.2},{id:"emergency_a1_002",type:"multiple_choice",situation:"Te dan comida en un restaurante",question:"¿Qué dices para agradecer?",options:["Thank you","Hello","Goodbye","You're welcome"],correct_answer:0,explanation:'Cuando alguien te da algo, debes agradecer diciendo "Thank you".',level:"A1",skill_focus:"courtesy",difficulty:.2}],A2:[{id:"emergency_a2_001",type:"multiple_choice",situation:"Tu amigo pregunta sobre tu fin de semana",question:"¿Cómo dices que fuiste al cine ayer?",options:["I went to the movies yesterday","I go to movies","I will go to movies","I am going to movies"],correct_answer:0,explanation:'Para hablar del pasado usamos "went" (pasado de "go").',level:"A2",skill_focus:"past_experiences",difficulty:.4}],B1:[{id:"emergency_b1_001",type:"multiple_choice",situation:"In a job interview context",question:"How would you express your motivation for the position?",options:["I believe I can contribute to the team","I need money","I like jobs","This is a company"],correct_answer:0,explanation:"Professional responses should focus on contribution and value.",level:"B1",skill_focus:"work_situations",difficulty:.6}],B2:[{id:"emergency_b2_001",type:"multiple_choice",situation:"Business meeting discussion",question:"How do you diplomatically present a counterargument?",options:["While I understand your perspective, I'd like to propose...","You are wrong","That's not good","I disagree"],correct_answer:0,explanation:"Professional communication requires diplomatic language and respect.",level:"B2",skill_focus:"professional_communication",difficulty:.8}]};return console.log(`🚨 Usando ejercicios de emergencia para nivel ${t}`),s[t]||s.A1}}const Ra=({onComplete:r})=>{const[t,s]=g.useState(""),[a,i]=g.useState(!1),[n,o]=g.useState(""),[c,u]=g.useState(!1),[p,m]=g.useState("intro"),l=async j=>{try{const w=await new Et(j).generateExercises({userId:"test_user",level:"A1",weakAreas:[],completedExercises:0,sessionNumber:1});return w&&w.length>0}catch(y){return console.error("API Key validation error:",y),!1}},h=async()=>{if(!t.trim()){o("Por favor ingresa tu API Key");return}if(!t.startsWith("AIza")){o('La API Key debe comenzar con "AIza"');return}i(!0),o("");try{await l(t.trim())?(localStorage.setItem("gemini_api_key",t.trim()),r(t.trim())):o("API Key inválida o sin permisos. Verifica que esté activa y tenga acceso a Gemini.")}catch{o("Error validando API Key. Verifica tu conexión a internet.")}finally{i(!1)}},f={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.6,staggerChildren:.1}}},x={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}};return p==="intro"?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center p-4",children:e.jsxs(d.div,{variants:f,initial:"hidden",animate:"visible",className:"max-w-2xl mx-auto text-center space-y-8",children:[e.jsxs(d.div,{variants:x,children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx("span",{className:"text-white font-bold text-2xl",children:"EM"})}),e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-4",children:"¡Bienvenido a English Master!"}),e.jsx("p",{className:"text-xl text-gray-600 max-w-lg mx-auto",children:"La primera app de inglés 100% personalizada con IA que se adapta a tu nivel real"})]}),e.jsxs(d.div,{variants:x,className:"grid md:grid-cols-3 gap-6 my-12",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:[e.jsx("div",{className:"text-3xl mb-4",children:"🤖"}),e.jsx("h3",{className:"font-bold text-lg mb-2",children:"IA Personal"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Ejercicios únicos generados específicamente para tu nivel y debilidades"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:[e.jsx("div",{className:"text-3xl mb-4",children:"🇪🇸"}),e.jsx("h3",{className:"font-bold text-lg mb-2",children:"Pedagogía Real"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"A1: Preguntas en español → Respuestas en inglés. Lógica que funciona."})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:[e.jsx("div",{className:"text-3xl mb-4",children:"🚀"}),e.jsx("h3",{className:"font-bold text-lg mb-2",children:"Progreso Real"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"A1 → A2 → B1 → B2 con requisitos específicos y progresión lógica"})]})]}),e.jsx(d.div,{variants:x,children:e.jsx("button",{onClick:()=>m("setup"),className:"bg-gradient-to-r from-blue-500 to-purple-600 text-white px-8 py-4 rounded-xl font-bold text-lg shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105",children:"Comenzar Configuración"})})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center p-4",children:e.jsx(d.div,{variants:f,initial:"hidden",animate:"visible",className:"max-w-2xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 border border-gray-200/50",children:[e.jsxs(d.div,{variants:x,className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Qe,{className:"w-8 h-8 text-white"})}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Configura tu API Key Personal"}),e.jsx("p",{className:"text-gray-600",children:"Necesitas tu propia API Key de Google AI Studio para generar ejercicios únicos"})]}),e.jsx(d.div,{variants:x,className:"mb-8",children:e.jsxs("div",{className:"bg-blue-50 rounded-xl p-6 border border-blue-200",children:[e.jsxs("h3",{className:"font-bold text-blue-900 mb-4 flex items-center",children:[e.jsx(xe,{className:"w-5 h-5 mr-2"}),"¿Por qué necesitas tu propia API Key?"]}),e.jsxs("div",{className:"space-y-3 text-sm text-blue-800",children:[e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(K,{className:"w-4 h-4 mt-0.5 text-blue-600"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Control total:"})," Tus datos y progreso son 100% privados"]})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(K,{className:"w-4 h-4 mt-0.5 text-blue-600"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Ejercicios ilimitados:"})," Genera tantos como necesites"]})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(K,{className:"w-4 h-4 mt-0.5 text-blue-600"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Personalización máxima:"})," IA adaptada a tu progreso específico"]})]})]})]})}),e.jsxs(d.div,{variants:x,className:"mb-8",children:[e.jsxs("h3",{className:"font-bold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ze,{className:"w-5 h-5 mr-2 text-yellow-500"}),"Cómo obtener tu API Key (2 minutos):"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"1"}),e.jsx("div",{className:"flex-1",children:e.jsxs("p",{className:"text-gray-800",children:["Ve a"," ",e.jsxs("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 font-medium inline-flex items-center",children:["Google AI Studio",e.jsx(ls,{className:"w-4 h-4 ml-1"})]})]})})]}),e.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"2"}),e.jsx("p",{className:"text-gray-800 flex-1",children:'Haz clic en "Create API Key" y selecciona tu proyecto'})]}),e.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"3"}),e.jsx("p",{className:"text-gray-800 flex-1",children:"Copia la API Key y pégala abajo"})]})]})]}),e.jsxs(d.div,{variants:x,className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Google AI Studio API Key"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:c?"text":"password",value:t,onChange:j=>{s(j.target.value),o("")},placeholder:"AIzaSy...",className:"w-full p-4 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors text-lg font-mono",disabled:a}),e.jsx("button",{type:"button",onClick:()=>u(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:c?e.jsx(ye,{className:"w-5 h-5"}):e.jsx(ve,{className:"w-5 h-5"})})]})]}),n&&e.jsxs(d.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-xl flex items-start space-x-3",children:[e.jsx(Ye,{className:"w-5 h-5 text-red-500 mt-0.5"}),e.jsx("p",{className:"text-red-700 text-sm",children:n})]}),e.jsx(d.button,{variants:x,onClick:h,disabled:!t.trim()||a,className:"w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white py-4 rounded-xl font-bold text-lg shadow-lg hover:shadow-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",whileHover:a?{}:{scale:1.01},whileTap:a?{}:{scale:.99},children:a?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(d.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full"}),e.jsx("span",{children:"Validando API Key..."})]}):e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(ee,{className:"w-5 h-5"}),e.jsx("span",{children:"Validar y Continuar"})]})}),e.jsx(d.div,{variants:x,className:"mt-6",children:e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(xe,{className:"w-5 h-5 text-green-600 mt-0.5"}),e.jsxs("div",{className:"text-sm text-green-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"🔒 Tu API Key es segura"}),e.jsx("p",{children:"Se almacena localmente en tu dispositivo y solo se usa para generar tus ejercicios personalizados."})]})]})})})]})})})};class Ma{db=re();async cleanAllUserHistory(t){try{console.log(`🧹 Limpiando historial completo para usuario: ${t}`),await this.cleanFirebaseHistory(t),this.cleanLocalStorageHistory(t),console.log(`✅ Historial limpiado completamente para ${t}`)}catch(s){console.error("❌ Error limpiando historial:",s)}}async cleanFirebaseHistory(t){try{const s=Pe(this.db),a=Q(Y(this.db,"exerciseHistory"),q("userId","==",t)),i=await Z(a);i.docs.forEach(n=>{s.delete(n.ref)}),await s.commit(),console.log(`🔥 ${i.size} registros eliminados de Firebase`)}catch(s){console.error("❌ Error limpiando Firebase:",s)}}cleanLocalStorageHistory(t){try{const s=["content_hashes_A1","content_hashes_A2","content_hashes_B1","content_hashes_B2","used_sessions_A1","used_sessions_A2","used_sessions_B1","used_sessions_B2","all_exercise_hashes_A1","all_exercise_hashes_A2","all_exercise_hashes_B1","all_exercise_hashes_B2",`user_exercise_history_${t}`,`last_questions_${t}`,`question_bank_${t}`];s.forEach(a=>{localStorage.removeItem(a)}),console.log(`🧹 ${s.length} claves limpiadas del localStorage`)}catch(s){console.error("❌ Error limpiando localStorage:",s)}}async cleanOldHistory(t){try{const s=new Date;s.setDate(s.getDate()-30);const a=Pe(this.db),i=Q(Y(this.db,"exerciseHistory"),q("userId","==",t),q("timestamp","<",s)),n=await Z(i);n.docs.forEach(o=>{a.delete(o.ref)}),await a.commit(),console.log(`🗑️ ${n.size} registros antiguos eliminados`)}catch(s){console.error("❌ Error limpiando historial antiguo:",s)}}async getRepetitionStats(t){try{const s=Q(Y(this.db,"exerciseHistory"),q("userId","==",t)),i=(await Z(s)).docs.map(c=>c.data()),n={};i.forEach(c=>{n[c.questionText]=(n[c.questionText]||0)+1});const o=Object.entries(n).sort(([,c],[,u])=>u-c).slice(0,10);return{totalExercises:i.length,uniqueQuestions:Object.keys(n).length,repetitionRate:1-Object.keys(n).length/i.length,mostRepeated:o.map(([c,u])=>({question:c,count:u}))}}catch(s){return console.error("❌ Error obteniendo stats:",s),null}}}const Oa=({userProgress:r,onStartSession:t,onViewProgress:s,onSettings:a})=>{const[i,n]=g.useState(null),[o,c]=g.useState(!1),u=new oe,p=new Ma;g.useEffect(()=>{const h=r.levelProgress[r.currentLevel],f=u.calculateProgress(r.currentLevel,h);n(f)},[r]);const m={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.6,staggerChildren:.1}}},l={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}};return e.jsxs(d.div,{variants:m,initial:"hidden",animate:"visible",className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50",children:[e.jsx(d.header,{variants:l,className:"bg-white/80 backdrop-blur-lg border-b border-gray-200/50 sticky top-0 z-40",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs(d.div,{whileHover:{scale:1.05},className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-sm",children:"EM"})}),e.jsx("h1",{className:"text-xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"English Master"})]})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(d.div,{whileHover:{scale:1.02},className:"text-right",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[r.email.split("@")[0]," 👋"]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Nivel ",r.currentLevel," • ",r.currentStreak," días seguidos"]})]}),e.jsx(d.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:a,className:"p-2 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors",children:e.jsx(et,{className:"w-5 h-5 text-gray-600"})})]})]})})}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs(d.div,{variants:l,className:`
              relative overflow-hidden rounded-2xl p-6 border-2 transition-all duration-500
              ${i?.canLevelUp?"bg-gradient-to-r from-green-50 to-emerald-50 border-green-300 shadow-green-100":"bg-gradient-to-r from-blue-50 to-purple-50 border-blue-300 shadow-blue-100"} shadow-xl
            `,children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs(d.h2,{className:`text-3xl font-bold mb-2 ${i?.canLevelUp?"text-green-800":"text-blue-800"}`,children:["📈 Nivel ",r.currentLevel," → ",i?.nextLevel]}),e.jsx("p",{className:`text-sm ${i?.canLevelUp?"text-green-700":"text-blue-700"}`,children:i?.canLevelUp?"🎉 ¡Listo para subir de nivel!":i?.requirements.description})]}),e.jsx(d.div,{animate:{scale:i?.canLevelUp?[1,1.1,1]:1,rotate:i?.canLevelUp?[0,5,-5,0]:0},transition:{duration:2,repeat:i?.canLevelUp?1/0:0},className:"text-center",children:e.jsxs("div",{className:`
                  inline-flex items-center justify-center w-20 h-20 rounded-full text-3xl font-bold
                  ${i?.canLevelUp?"bg-green-500 text-white shadow-lg shadow-green-200":"bg-white text-blue-600 shadow-lg"}
                `,children:[i?.progressPercentage||0,"%"]})})]}),e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4 overflow-hidden",children:e.jsx(d.div,{initial:{width:0},animate:{width:`${i?.progressPercentage||0}%`},transition:{duration:1.5,ease:"easeOut"},className:`h-full rounded-full ${i?.canLevelUp?"bg-gradient-to-r from-green-400 to-emerald-500":"bg-gradient-to-r from-blue-400 to-purple-500"}`})})}),i&&!i.canLevelUp&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-xs",children:i.blockedBy.map((h,f)=>e.jsx(d.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:f*.1},className:"bg-white/50 rounded-lg p-2 text-center",children:e.jsx("span",{className:"text-gray-600",children:h})},f))}),i?.canLevelUp&&e.jsx(d.button,{initial:{scale:0},animate:{scale:1},whileHover:{scale:1.05},whileTap:{scale:.95},className:"w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white py-3 rounded-xl font-bold text-lg shadow-lg hover:shadow-xl transition-shadow",onClick:()=>c(!0),children:"🎉 ¡SUBIR DE NIVEL!"})]}),e.jsxs(d.div,{variants:l,className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(X,{title:"XP Total",value:r.totalXP.toLocaleString(),icon:e.jsx(tt,{className:"w-6 h-6"}),color:"yellow",subtitle:"+50 hoy"}),e.jsx(X,{title:"Precisión",value:`${Math.round(r.overallAccuracy*100)}%`,icon:e.jsx(G,{className:"w-6 h-6"}),color:"blue",subtitle:"Meta: 85%"}),e.jsx(X,{title:"Racha",value:`${r.currentStreak} días`,icon:e.jsx(K,{className:"w-6 h-6"}),color:"orange",subtitle:`Récord: ${r.longestStreak}`}),e.jsx(X,{title:"Tiempo Total",value:`${Math.round(r.totalTimeSpent/60)}h`,icon:e.jsx(st,{className:"w-6 h-6"}),color:"green",subtitle:"Esta semana"})]}),e.jsxs(d.div,{variants:l,className:"bg-white rounded-2xl p-6 shadow-xl border border-gray-200/50",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Tu Camino de Aprendizaje"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:["A1","A2","B1","B2"].map((h,f)=>{const x=r.levelProgress[h],j=r.currentLevel===h,y=x.isCompleted,w=x.isUnlocked;return e.jsx(Da,{level:h,stats:x,isCurrent:j,isCompleted:y,isUnlocked:w,index:f},h)})})]}),e.jsxs(d.div,{variants:l,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(d.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:t,className:"bg-gradient-to-r from-blue-500 to-purple-600 text-white p-6 rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300",children:e.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[e.jsx(cs,{className:"w-8 h-8"}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-xl font-bold",children:"Comenzar Sesión"}),e.jsx("p",{className:"text-blue-100",children:"8 ejercicios únicos y personalizados"})]})]})}),e.jsx(d.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:s,className:"bg-white border-2 border-gray-200 text-gray-900 p-6 rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300",children:e.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[e.jsx(at,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-xl font-bold",children:"Ver Progreso"}),e.jsx("p",{className:"text-gray-600",children:"Análisis detallado"})]})]})})]}),e.jsx("div",{className:"bg-yellow-50 border-2 border-yellow-200 rounded-2xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-yellow-800",children:"¿Ves preguntas repetidas?"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"Limpia el historial para obtener ejercicios completamente nuevos"})]}),e.jsx(d.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:async()=>{try{await p.cleanAllUserHistory(r.userId),alert("🎉 ¡Historial limpiado! Las próximas sesiones tendrán ejercicios completamente nuevos.")}catch{alert("❌ Error limpiando historial. Inténtalo de nuevo.")}},className:"bg-yellow-500 hover:bg-yellow-600 text-white px-6 py-2 rounded-lg font-medium transition-colors",children:"🧹 Limpiar Historial"})]})})]})]})}),e.jsx(te,{children:o&&e.jsx(Ua,{newLevel:i?.nextLevel||"A2",onClose:()=>c(!1)})})]})},X=({title:r,value:t,icon:s,color:a,subtitle:i})=>{const n={yellow:"from-yellow-400 to-orange-500 text-yellow-600",blue:"from-blue-400 to-blue-600 text-blue-600",orange:"from-orange-400 to-red-500 text-orange-600",green:"from-green-400 to-emerald-500 text-green-600"};return e.jsxs(d.div,{whileHover:{y:-4},className:"bg-white rounded-xl p-6 shadow-lg border border-gray-200/50 hover:shadow-xl transition-all duration-300",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:`p-3 rounded-lg bg-gradient-to-r ${n[a]}`,children:e.jsx("div",{className:"text-white",children:s})})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-1",children:t}),e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:r}),e.jsx("p",{className:"text-xs text-gray-500",children:i})]})},Da=({level:r,stats:t,isCurrent:s,isCompleted:a,isUnlocked:i,index:n})=>e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:n*.1},className:`
        p-4 rounded-xl border-2 text-center transition-all duration-300 cursor-pointer
        ${s?"border-blue-500 bg-blue-50 shadow-lg shadow-blue-100":a?"border-green-500 bg-green-50 shadow-lg shadow-green-100":i?"border-gray-300 bg-gray-50 hover:border-gray-400":"border-gray-200 bg-gray-100 opacity-50 cursor-not-allowed"}
      `,whileHover:i?{scale:1.02}:{},children:[e.jsx("div",{className:"text-3xl mb-2",children:a?"🏆":s?"🎯":i?"🔓":"🔒"}),e.jsx("div",{className:"font-bold text-lg mb-1",children:r}),e.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[t.exercisesCompleted," ejercicios"]}),a&&t.completedAt&&e.jsxs("div",{className:"text-xs text-green-600",children:["Completado ",new Date(t.completedAt).toLocaleDateString()]}),s&&e.jsxs("div",{className:"text-xs text-blue-600 font-medium",children:[Math.round(t.accuracy*100),"% precisión"]})]}),Ua=({newLevel:r,onClose:t})=>e.jsx(d.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:t,children:e.jsxs(d.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},exit:{scale:0,rotate:180},transition:{type:"spring",duration:.8},className:"bg-white p-8 rounded-2xl text-center shadow-2xl max-w-md mx-4",onClick:s=>s.stopPropagation(),children:[e.jsx(d.div,{animate:{scale:[1,1.2,1],rotate:[0,10,-10,0]},transition:{duration:2,repeat:1/0},className:"text-6xl mb-4",children:"🎉"}),e.jsx("h2",{className:"text-3xl font-bold text-yellow-500 mb-2",children:"¡LEVEL UP!"}),e.jsxs("p",{className:"text-xl text-gray-800 mb-4",children:["¡Ahora eres nivel ",e.jsx("span",{className:"font-bold text-blue-600",children:r}),"!"]}),e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 p-4 rounded-xl mb-6",children:e.jsx("p",{className:"text-sm text-gray-600",children:"Has desbloqueado nuevos ejercicios y desafíos más avanzados"})}),e.jsx(d.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:t,className:"bg-gradient-to-r from-blue-500 to-purple-600 text-white px-8 py-3 rounded-xl font-bold shadow-lg",children:"¡Continuar Aprendiendo!"})]})}),$a=({userProgress:r,apiKey:t,onComplete:s,onExit:a})=>{const[i,n]=g.useState([]),[o,c]=g.useState(0),[u,p]=g.useState(null),[m,l]=g.useState(!1),[h,f]=g.useState(!0),[x]=g.useState(new Date),[j,y]=g.useState(0),[w,_]=g.useState(0),[b,M]=g.useState([]),[le,H]=g.useState([]),U=new Et(t),v=i[o],Se=o===i.length-1;g.useEffect(()=>{const N=setInterval(()=>{_(Math.floor((Date.now()-x.getTime())/1e3/60))},6e4);return()=>clearInterval(N)},[x]),g.useEffect(()=>{_e()},[]);const _e=async()=>{try{f(!0);const N=r.levelProgress[r.currentLevel],I=await U.generateExercises({userId:r.userId,level:r.currentLevel,weakAreas:N.weakAreas,completedExercises:N.exercisesCompleted,sessionNumber:N.sessionsCompleted+1});n(I),f(!1),console.log(`🎯 Sesión generada: ${I.length} ejercicios nivel ${r.currentLevel}`)}catch(N){console.error("❌ Error generando sesión:",N),f(!1)}},At=N=>{if(m)return;p(N),l(!0),N===v.correct_answer?y(P=>P+1):H(P=>[...P,v.skill_focus]),M(P=>Array.from(new Set([...P,v.skill_focus])))},St=()=>{Se?_t():(c(N=>N+1),p(null),l(!1))},_t=()=>{const N={userId:r.userId,sessionId:`session_${Date.now()}`,level:r.currentLevel,exercisesCompleted:i.length,correctAnswers:j,totalAnswers:i.length,accuracy:j/i.length,xpEarned:j*10+i.length*5,timeSpent:w,skillsFocused:Array.from(new Set(b)),weakAreasIdentified:Array.from(new Set(le)),startTime:x,endTime:new Date};s(N)},It=N=>{if("speechSynthesis"in window){const I=new SpeechSynthesisUtterance(N);I.lang="en-US",I.rate=.8,speechSynthesis.speak(I)}};return h?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 flex items-center justify-center",children:e.jsxs(d.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-center",children:[e.jsx(d.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Generando tu sesión personalizada..."}),e.jsxs("p",{className:"text-gray-600",children:["Creando ejercicios específicos para tu nivel ",r.currentLevel]})]})}):i.length?e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50",children:[e.jsx("header",{className:"bg-white/80 backdrop-blur-lg border-b border-gray-200/50 sticky top-0 z-40",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:a,className:"flex items-center space-x-2 text-gray-600 hover:text-gray-800 transition-colors",children:[e.jsx(je,{className:"w-5 h-5"}),e.jsx("span",{children:"Salir"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(G,{className:"w-4 h-4"}),e.jsxs("span",{children:[j,"/",i.length]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(st,{className:"w-4 h-4"}),e.jsxs("span",{children:[w," min"]})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[e.jsx("span",{children:"Progreso"}),e.jsxs("span",{children:[o+1," de ",i.length]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx(d.div,{initial:{width:0},animate:{width:`${(o+1)/i.length*100}%`},transition:{duration:.3},className:"bg-gradient-to-r from-blue-500 to-purple-600 h-2 rounded-full"})})]})]})}),e.jsx("main",{className:"max-w-4xl mx-auto px-4 py-8",children:e.jsx(te,{mode:"wait",children:e.jsx(d.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},transition:{duration:.3},className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-xl border border-gray-200/50",children:[v.situation&&e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-blue-50 rounded-xl p-4 mb-6",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-800 mb-2",children:"Situación:"}),e.jsx("p",{className:"text-blue-700",children:v.situation})]}),e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:v.question}),e.jsx("button",{onClick:()=>It(v.question),className:"p-2 text-gray-400 hover:text-blue-500 transition-colors",children:e.jsx(rt,{className:"w-5 h-5"})})]}),e.jsx("p",{className:"text-gray-600",children:"Selecciona la respuesta correcta:"})]}),e.jsx("div",{className:"space-y-3 mb-8",children:v.options.map((N,I)=>{const P=u===I,z=I===v.correct_answer,Ie=m;let F="w-full p-4 text-left rounded-xl border-2 transition-all duration-300 ";return Ie?z?F+="border-green-500 bg-green-50 text-green-800":P&&!z?F+="border-red-500 bg-red-50 text-red-800":F+="border-gray-200 bg-gray-100 text-gray-600":F+=P?"border-blue-500 bg-blue-50 text-blue-800":"border-gray-200 bg-gray-50 hover:border-gray-300 hover:bg-gray-100",e.jsx(d.button,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2+I*.1},onClick:()=>At(I),disabled:m,className:F,whileHover:m?{}:{scale:1.01},whileTap:m?{}:{scale:.99},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("span",{className:"text-lg font-bold",children:[String.fromCharCode(65+I),")"]}),e.jsx("span",{className:"text-lg",children:N})]}),Ie&&e.jsxs("div",{children:[z&&e.jsx(ee,{className:"w-6 h-6 text-green-500"}),P&&!z&&e.jsx(Le,{className:"w-6 h-6 text-red-500"})]})]})},I)})}),e.jsx(te,{children:m&&e.jsx(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:`rounded-xl p-6 mb-6 ${u===v.correct_answer?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"mt-1",children:u===v.correct_answer?e.jsx(ee,{className:"w-6 h-6 text-green-500"}):e.jsx(Le,{className:"w-6 h-6 text-red-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`font-bold mb-2 ${u===v.correct_answer?"text-green-800":"text-red-800"}`,children:u===v.correct_answer?"🎉 ¡Correcto! +10 XP":"❌ Incorrecto, pero +3 XP por intentar"}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(Ze,{className:"w-5 h-5 text-blue-500 mt-0.5 flex-shrink-0"}),e.jsxs("p",{className:"text-gray-700",children:[e.jsx("strong",{children:"Explicación:"})," ",v.explanation]})]})]})]})})}),m&&e.jsx(d.button,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},onClick:St,className:"w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white py-4 rounded-xl font-bold text-lg shadow-lg hover:shadow-xl transition-all duration-300",whileHover:{scale:1.01},whileTap:{scale:.99},children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("span",{children:Se?"Completar Sesión":"Siguiente Pregunta"}),e.jsx(us,{className:"w-5 h-5"})]})})]})},o)})})]}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-orange-50 flex items-center justify-center",children:e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center max-w-md mx-4",children:[e.jsx("div",{className:"text-6xl mb-4",children:"😕"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No se pudieron generar ejercicios"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Verifica tu conexión y API key, luego intenta de nuevo."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:_e,className:"w-full bg-blue-500 text-white py-3 rounded-xl font-medium hover:bg-blue-600 transition-colors",children:[e.jsx(ds,{className:"w-5 h-5 inline mr-2"}),"Intentar de nuevo"]}),e.jsx("button",{onClick:a,className:"w-full bg-gray-200 text-gray-800 py-3 rounded-xl font-medium hover:bg-gray-300 transition-colors",children:"Volver al Dashboard"})]})]})})},qa=({userProgress:r,onBack:t})=>{const[s,a]=g.useState("week"),[i,n]=g.useState("overview"),o=[{day:"Lun",exercises:12,accuracy:85,xp:120},{day:"Mar",exercises:8,accuracy:78,xp:95},{day:"Mié",exercises:15,accuracy:92,xp:150},{day:"Jue",exercises:10,accuracy:88,xp:110},{day:"Vie",exercises:18,accuracy:94,xp:180},{day:"Sáb",exercises:6,accuracy:75,xp:70},{day:"Dom",exercises:9,accuracy:82,xp:95}],c=[{level:"A1",progress:100,color:"#10B981"},{level:"A2",progress:65,color:"#3B82F6"},{level:"B1",progress:25,color:"#8B5CF6"},{level:"B2",progress:0,color:"#6B7280"}],u=[{skill:"Saludos",mastery:95,exercises:45},{skill:"Necesidades Básicas",mastery:88,exercises:32},{skill:"Cortesía",mastery:92,exercises:28},{skill:"Información Personal",mastery:78,exercises:24},{skill:"Rutinas Diarias",mastery:65,exercises:18}],p={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.6,staggerChildren:.1}}},m={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}};return e.jsxs(d.div,{variants:p,initial:"hidden",animate:"visible",className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50",children:[e.jsx(d.header,{variants:m,className:"bg-white/80 backdrop-blur-lg border-b border-gray-200/50 sticky top-0 z-40",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs("button",{onClick:t,className:"flex items-center space-x-2 text-gray-600 hover:text-gray-800 transition-colors",children:[e.jsx(je,{className:"w-5 h-5"}),e.jsx("span",{children:"Volver al Dashboard"})]}),e.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Mi Progreso"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("select",{value:s,onChange:l=>a(l.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"week",children:"Esta semana"}),e.jsx("option",{value:"month",children:"Este mes"}),e.jsx("option",{value:"all",children:"Todo el tiempo"})]})})]}),e.jsx("div",{className:"flex space-x-8 border-b border-gray-200",children:[{id:"overview",label:"Resumen",icon:at},{id:"levels",label:"Niveles",icon:ms},{id:"skills",label:"Habilidades",icon:G},{id:"achievements",label:"Logros",icon:ps}].map(l=>{const h=l.icon;return e.jsxs("button",{onClick:()=>n(l.id),className:`flex items-center space-x-2 py-4 border-b-2 transition-colors ${i===l.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(h,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:l.label})]},l.id)})})]})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[i==="overview"&&e.jsxs("div",{className:"space-y-8",children:[e.jsxs(d.div,{variants:m,className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(J,{title:"Total XP",value:r.totalXP.toLocaleString(),icon:e.jsx(tt,{className:"w-6 h-6"}),color:"yellow",change:"+12%",period:"esta semana"}),e.jsx(J,{title:"Ejercicios",value:r.totalExercises.toString(),icon:e.jsx(hs,{className:"w-6 h-6"}),color:"blue",change:"+8%",period:"esta semana"}),e.jsx(J,{title:"Precisión",value:`${Math.round(r.overallAccuracy*100)}%`,icon:e.jsx(G,{className:"w-6 h-6"}),color:"green",change:"+3%",period:"esta semana"}),e.jsx(J,{title:"Racha",value:`${r.currentStreak} días`,icon:e.jsx(K,{className:"w-6 h-6"}),color:"orange",change:"Activa",period:`récord: ${r.longestStreak}`})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs(d.div,{variants:m,className:"bg-white rounded-2xl p-6 shadow-xl border border-gray-200/50",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Progreso Semanal"}),e.jsx(Re,{width:"100%",height:300,children:e.jsxs(Es,{data:o,children:[e.jsx(Me,{strokeDasharray:"3 3"}),e.jsx(Oe,{dataKey:"day"}),e.jsx(De,{}),e.jsx(Ue,{}),e.jsx($e,{type:"monotone",dataKey:"exercises",stroke:"#3B82F6",strokeWidth:3,dot:{fill:"#3B82F6",strokeWidth:2,r:4}}),e.jsx($e,{type:"monotone",dataKey:"accuracy",stroke:"#10B981",strokeWidth:3,dot:{fill:"#10B981",strokeWidth:2,r:4}})]})})]}),e.jsxs(d.div,{variants:m,className:"bg-white rounded-2xl p-6 shadow-xl border border-gray-200/50",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Distribución de XP"}),e.jsx(Re,{width:"100%",height:300,children:e.jsxs(As,{data:o,children:[e.jsx(Me,{strokeDasharray:"3 3"}),e.jsx(Oe,{dataKey:"day"}),e.jsx(De,{}),e.jsx(Ue,{}),e.jsx(Ss,{dataKey:"xp",fill:"url(#xpGradient)",radius:[4,4,0,0]}),e.jsx("defs",{children:e.jsxs("linearGradient",{id:"xpGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#8B5CF6",stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:"#8B5CF6",stopOpacity:.3})]})})]})})]})]})]}),i==="levels"&&e.jsx(d.div,{variants:m,className:"space-y-8",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-xl border border-gray-200/50",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Progreso por Niveles"}),e.jsx("div",{className:"space-y-6",children:c.map((l,h)=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:l.color}}),e.jsxs("span",{className:"font-semibold text-lg",children:["Nivel ",l.level]}),l.level===r.currentLevel&&e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium",children:"Actual"})]}),e.jsxs("span",{className:"text-sm text-gray-600",children:[l.progress,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx(d.div,{initial:{width:0},animate:{width:`${l.progress}%`},transition:{duration:1,delay:h*.2},className:"h-3 rounded-full",style:{backgroundColor:l.color}})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Ejercicios:"})," ",r.levelProgress[l.level]?.exercisesCompleted||0]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Precisión:"})," ",Math.round((r.levelProgress[l.level]?.accuracy||0)*100),"%"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"XP:"})," ",r.levelProgress[l.level]?.xpEarned||0]})]})]},l.level))})]})}),i==="skills"&&e.jsx(d.div,{variants:m,className:"space-y-8",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-xl border border-gray-200/50",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Dominio de Habilidades"}),e.jsx("div",{className:"space-y-6",children:u.map((l,h)=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-semibold",children:l.skill}),e.jsxs("div",{className:"text-right text-sm text-gray-600",children:[e.jsxs("div",{children:[l.mastery,"% dominada"]}),e.jsxs("div",{children:[l.exercises," ejercicios"]})]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx(d.div,{initial:{width:0},animate:{width:`${l.mastery}%`},transition:{duration:1,delay:h*.1},className:`h-3 rounded-full ${l.mastery>=90?"bg-green-500":l.mastery>=70?"bg-blue-500":l.mastery>=50?"bg-yellow-500":"bg-red-500"}`})})]},l.skill))})]})}),i==="achievements"&&e.jsx(d.div,{variants:m,className:"space-y-8",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx($,{title:"Primer Paso",description:"Completa tu primera sesión",icon:"🎯",unlocked:!0,date:"Hace 5 días"}),e.jsx($,{title:"Saludador Experto",description:"Domina los saludos básicos",icon:"👋",unlocked:!0,date:"Hace 3 días"}),e.jsx($,{title:"Racha de Fuego",description:"Mantén una racha de 7 días",icon:"🔥",unlocked:r.currentStreak>=7,date:r.currentStreak>=7?"Hoy":void 0}),e.jsx($,{title:"Maestro A1",description:"Completa el nivel A1",icon:"🏆",unlocked:!1}),e.jsx($,{title:"Precisión Perfecta",description:"Logra 95% de precisión",icon:"🎯",unlocked:r.overallAccuracy>=.95}),e.jsx($,{title:"Explorador B1",description:"Desbloquea el nivel B1",icon:"🗺️",unlocked:!1})]})})]})]})},J=({title:r,value:t,icon:s,color:a,change:i,period:n})=>{const o={yellow:"from-yellow-400 to-orange-500 text-yellow-600",blue:"from-blue-400 to-blue-600 text-blue-600",green:"from-green-400 to-emerald-500 text-green-600",orange:"from-orange-400 to-red-500 text-orange-600"};return e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-gray-200/50",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:`p-3 rounded-lg bg-gradient-to-r ${o[a]}`,children:e.jsx("div",{className:"text-white",children:s})})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-1",children:t}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:r}),e.jsxs("div",{className:"flex items-center space-x-1 text-xs",children:[e.jsx("span",{className:"text-green-600 font-medium",children:i}),e.jsx("span",{className:"text-gray-500",children:n})]})]})},$=({title:r,description:t,icon:s,unlocked:a,date:i})=>e.jsx("div",{className:`
    p-6 rounded-xl border-2 transition-all duration-300
    ${a?"bg-gradient-to-br from-yellow-50 to-orange-50 border-yellow-300 shadow-lg":"bg-gray-50 border-gray-200 opacity-60"}
  `,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl mb-3",children:a?s:"🔒"}),e.jsx("h3",{className:"font-bold text-lg mb-2",children:r}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:t}),a&&i&&e.jsxs("p",{className:"text-xs text-green-600 font-medium",children:["Desbloqueado ",i]}),!a&&e.jsx("p",{className:"text-xs text-gray-500",children:"Bloqueado"})]})}),Ba=({userProgress:r,onBack:t,onUpdateProgress:s})=>{const[a,i]=g.useState("profile"),[n,o]=g.useState(!1),[c,u]=g.useState(!1),[p,m]=g.useState(r.preferences),[l,h]=g.useState(""),f=async()=>{try{o(!0);const b={...r,preferences:p};s(b),A.success("Preferencias guardadas exitosamente")}catch(b){console.error("Error saving preferences:",b),A.error("Error guardando preferencias")}finally{o(!1)}},x=async()=>{if(!l.trim()){A.error("Ingresa una API Key válida");return}try{o(!0),localStorage.setItem("gemini_api_key",l);const b={...r,apiKey:btoa(l)};s(b),A.success("API Key actualizada exitosamente"),h("")}catch(b){console.error("Error updating API key:",b),A.error("Error actualizando API Key")}finally{o(!1)}},j=async()=>{try{await as(O),A.success("Sesión cerrada exitosamente")}catch(b){console.error("Error signing out:",b),A.error("Error cerrando sesión")}},y=async()=>{if(window.confirm("¿Estás seguro de que quieres eliminar tu cuenta? Esta acción no se puede deshacer."))try{o(!0),A.success("Cuenta eliminada exitosamente")}catch(M){console.error("Error deleting account:",M),A.error("Error eliminando cuenta")}finally{o(!1)}},w={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.6,staggerChildren:.1}}},_={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}};return e.jsxs(d.div,{variants:w,initial:"hidden",animate:"visible",className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50",children:[e.jsx(d.header,{variants:_,className:"bg-white/80 backdrop-blur-lg border-b border-gray-200/50 sticky top-0 z-40",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs("button",{onClick:t,className:"flex items-center space-x-2 text-gray-600 hover:text-gray-800 transition-colors",children:[e.jsx(je,{className:"w-5 h-5"}),e.jsx("span",{children:"Volver al Dashboard"})]}),e.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Configuración"}),e.jsx("div",{className:"w-32"})," "]}),e.jsx("div",{className:"flex space-x-8 border-b border-gray-200",children:[{id:"profile",label:"Perfil",icon:xs},{id:"preferences",label:"Preferencias",icon:et},{id:"api",label:"API Key",icon:Qe},{id:"privacy",label:"Privacidad",icon:xe}].map(b=>{const M=b.icon;return e.jsxs("button",{onClick:()=>i(b.id),className:`flex items-center space-x-2 py-4 border-b-2 transition-colors ${a===b.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(M,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:b.label})]},b.id)})})]})}),e.jsx("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-200/50 overflow-hidden",children:[a==="profile"&&e.jsxs(d.div,{variants:_,className:"p-8 space-y-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Información del Perfil"}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-2xl",children:r.email.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:r.email.split("@")[0]}),e.jsx("p",{className:"text-gray-600",children:r.email}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Miembro desde ",new Date(r.createdAt).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-blue-50 p-6 rounded-xl border border-blue-200",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"Nivel Actual"}),e.jsx("p",{className:"text-2xl font-bold text-blue-700",children:r.currentLevel})]}),e.jsxs("div",{className:"bg-green-50 p-6 rounded-xl border border-green-200",children:[e.jsx("h4",{className:"font-semibold text-green-900 mb-2",children:"Total XP"}),e.jsx("p",{className:"text-2xl font-bold text-green-700",children:r.totalXP.toLocaleString()})]}),e.jsxs("div",{className:"bg-purple-50 p-6 rounded-xl border border-purple-200",children:[e.jsx("h4",{className:"font-semibold text-purple-900 mb-2",children:"Racha Actual"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-700",children:[r.currentStreak," días"]})]})]})]}),a==="preferences"&&e.jsxs(d.div,{variants:_,className:"p-8 space-y-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Preferencias"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(G,{className:"w-4 h-4 inline mr-2"}),"Meta diaria de ejercicios"]}),e.jsxs("select",{value:p.dailyGoal,onChange:b=>m({...p,dailyGoal:parseInt(b.target.value)}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:10,children:"10 ejercicios"}),e.jsx("option",{value:20,children:"20 ejercicios"}),e.jsx("option",{value:30,children:"30 ejercicios"}),e.jsx("option",{value:50,children:"50 ejercicios"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(gs,{className:"w-4 h-4 inline mr-2"}),"Recordatorio diario"]}),e.jsx("input",{type:"time",value:p.reminderTime||"19:00",onChange:b=>m({...p,reminderTime:b.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:p.soundEnabled,onChange:b=>m({...p,soundEnabled:b.target.checked}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx(rt,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Habilitar sonidos y pronunciación"})]})}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:p.animationsEnabled,onChange:b=>m({...p,animationsEnabled:b.target.checked}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx(fs,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Habilitar animaciones"})]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(bs,{className:"w-4 h-4 inline mr-2"}),"Idioma de explicaciones"]}),e.jsxs("select",{value:p.explanationLanguage,onChange:b=>m({...p,explanationLanguage:b.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"es",children:"Español"}),e.jsx("option",{value:"en",children:"English"})]})]}),e.jsxs("button",{onClick:f,disabled:n,className:"w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white py-3 rounded-xl font-bold shadow-lg hover:shadow-xl transition-all duration-300 disabled:opacity-50",children:[e.jsx(ys,{className:"w-5 h-5 inline mr-2"}),n?"Guardando...":"Guardar Preferencias"]})]})]}),a==="api"&&e.jsxs(d.div,{variants:_,className:"p-8 space-y-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Gestión de API Key"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"API Key Actual"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:c?"text":"password",value:c?atob(r.apiKey):"••••••••••••••••",readOnly:!0,className:"flex-1 p-3 bg-white border border-blue-300 rounded-lg font-mono text-sm"}),e.jsx("button",{onClick:()=>u(!c),className:"p-3 text-blue-600 hover:text-blue-800 transition-colors",children:c?e.jsx(ye,{className:"w-5 h-5"}):e.jsx(ve,{className:"w-5 h-5"})})]}),e.jsx("p",{className:"text-sm text-blue-700 mt-2",children:"Tu API Key está segura y encriptada. Solo se usa para generar ejercicios personalizados."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nueva API Key (opcional)"}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("input",{type:"password",value:l,onChange:b=>h(b.target.value),placeholder:"AIzaSy...",className:"flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono"}),e.jsx("button",{onClick:x,disabled:n||!l.trim(),className:"bg-blue-500 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-600 transition-colors disabled:opacity-50",children:"Actualizar"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Solo actualiza tu API Key si necesitas cambiarla o si la actual no funciona."})]})]})]}),a==="privacy"&&e.jsxs(d.div,{variants:_,className:"p-8 space-y-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Privacidad y Seguridad"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-6",children:[e.jsx("h3",{className:"font-semibold text-green-900 mb-2",children:"🔒 Tus Datos están Seguros"}),e.jsxs("ul",{className:"text-sm text-green-800 space-y-1",children:[e.jsx("li",{children:"• Tu API Key se almacena encriptada"}),e.jsx("li",{children:"• Tus ejercicios se generan en tiempo real"}),e.jsx("li",{children:"• No compartimos tus datos con terceros"}),e.jsx("li",{children:"• Puedes exportar o eliminar tus datos en cualquier momento"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("button",{onClick:j,className:"w-full flex items-center justify-center space-x-2 bg-gray-100 text-gray-800 py-3 rounded-xl font-medium hover:bg-gray-200 transition-colors",children:[e.jsx(vs,{className:"w-5 h-5"}),e.jsx("span",{children:"Cerrar Sesión"})]}),e.jsxs("button",{onClick:y,disabled:n,className:"w-full flex items-center justify-center space-x-2 bg-red-100 text-red-800 py-3 rounded-xl font-medium hover:bg-red-200 transition-colors disabled:opacity-50",children:[e.jsx(js,{className:"w-5 h-5"}),e.jsx("span",{children:"Eliminar Cuenta"})]})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-6",children:[e.jsx("h3",{className:"font-semibold text-yellow-900 mb-2",children:"⚠️ Eliminar Cuenta"}),e.jsx("p",{className:"text-sm text-yellow-800",children:"Al eliminar tu cuenta se borrarán permanentemente todos tus datos, progreso, y configuraciones. Esta acción no se puede deshacer."})]})]})]})]})})]})},Fa=()=>e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 flex items-center justify-center",children:e.jsxs(d.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-center",children:[e.jsx(d.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"English Master"}),e.jsx("p",{className:"text-gray-600",children:"Cargando tu experiencia personalizada..."})]})});class Va extends Je.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,s){console.error("English Master Error:",t,s)}render(){return this.state.hasError?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-orange-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md mx-auto text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"😕"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Algo salió mal"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Ha ocurrido un error inesperado. Por favor recarga la página."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-500 text-white px-6 py-3 rounded-xl font-medium hover:bg-blue-600 transition-colors",children:"Recargar Página"})]})}):this.props.children}}const Ka=()=>{const[r,t]=g.useState(null),[s,a]=g.useState(null),[i,n]=g.useState(""),[o,c]=g.useState(!0),[u,p]=g.useState("dashboard"),m=new oe;g.useEffect(()=>rs(O,async x=>{try{if(x){console.log("👤 Usuario autenticado:",x.email),t(x);let j=await m.getUserProgress(x.uid);if(j){console.log("📊 Progreso del usuario cargado");const y=atob(j.apiKey);n(y)}else{console.log("🆕 Nuevo usuario detectado");const y=localStorage.getItem("gemini_api_key");y&&(console.log("🔑 API Key encontrada, inicializando progreso..."),j=await m.initializeUserProgress(x.uid,x.email,y),n(y))}a(j)}else console.log("👤 Usuario no autenticado"),t(null),a(null),n("")}catch(j){console.error("❌ Error en inicialización:",j)}finally{c(!1)}}),[]);const l=async f=>{if(!(!r||!s))try{console.log("📊 Completando sesión:",f);const x=await m.updateProgress(r.uid,f);a(x),x.currentLevel!==s.currentLevel&&console.log(`🎉 LEVEL UP: ${s.currentLevel} → ${x.currentLevel}`),p("dashboard")}catch(x){console.error("❌ Error completando sesión:",x)}},h=async f=>{if(r)try{console.log("🔑 Configurando API Key para usuario:",r.email);const x=await m.initializeUserProgress(r.uid,r.email,f);n(f),a(x),console.log("✅ Usuario inicializado exitosamente")}catch(x){console.error("❌ Error configurando API Key:",x)}};return o?e.jsx(Fa,{}):r?!i||!s?e.jsx(Ra,{onComplete:h}):e.jsxs(Va,{children:[e.jsx(Ct,{children:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50",children:e.jsx(te,{mode:"wait",children:e.jsxs(kt,{children:[e.jsx(Te,{path:"/",element:u==="dashboard"?e.jsx(Oa,{userProgress:s,onStartSession:()=>p("session"),onViewProgress:()=>p("progress"),onSettings:()=>p("settings")}):u==="session"?e.jsx($a,{userProgress:s,apiKey:i,onComplete:l,onExit:()=>p("dashboard")}):u==="progress"?e.jsx(qa,{userProgress:s,onBack:()=>p("dashboard")}):e.jsx(Ba,{userProgress:s,onBack:()=>p("dashboard"),onUpdateProgress:a})}),e.jsx(Te,{path:"*",element:e.jsx(Pt,{to:"/",replace:!0})})]})})})}),e.jsx(ws,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"}}})]}):e.jsx(La,{})};"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(r=>{console.log("SW registered: ",r)}).catch(r=>{console.log("SW registration failed: ",r)})});console.log("📊 Performance monitoring enabled");window.addEventListener("error",r=>{console.error("Global error:",r.error)});window.addEventListener("unhandledrejection",r=>{console.error("Unhandled promise rejection:",r.reason)});ge.createRoot(document.getElementById("root")).render(e.jsx(Je.StrictMode,{children:e.jsx(Ka,{})}));
//# sourceMappingURL=index-BOzcxI71.js.map
